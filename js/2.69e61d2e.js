(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"0bc2":function(t,e,n){},"0bd1":function(t,e,n){"use strict";var o=n("8105"),i=n.n(o);i.a},1217:function(t,e,n){"use strict";var o=n("ccd7"),i=n.n(o);i.a},"12f9":function(t,e,n){},1714:function(t,e,n){},"1db4":function(t,e,n){"use strict";var o=n("e7b5"),i=n.n(o);i.a},"2d40":function(t,e,n){"use strict";var o=n("9557"),i=n.n(o);i.a},"3a26":function(t,e,n){"use strict";var o=n("7a81"),i=n.n(o);i.a},"3eda":function(t,e,n){"use strict";var o=n("ff54"),i=n.n(o);i.a},"464f":function(t,e,n){},"49ee":function(t,e,n){"use strict";var o=n("464f"),i=n.n(o);i.a},"4c74":function(t,e,n){},"4fbe":function(t,e,n){"use strict";var o=n("12f9"),i=n.n(o);i.a},"4fc6":function(t,e,n){"use strict";var o=n("a4da"),i=n.n(o);i.a},"5f28":function(t,e,n){},6163:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"page-editor-home row col-12",class:t.styles},[n("section",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"},{name:"show",rawName:"v-show",value:t.isShowNoteList,expression:"isShowNoteList"}],staticClass:"col-sm-12 col-md-3 o-note-list"},[n("header",{staticClass:"row col-12 items-center"},[n("div",{staticClass:"row col-12 justify-between panel"},[n("div",{staticClass:"self-center q-px-sm"},[n("q-icon",{attrs:{name:"folder"}}),t._v("\n          "+t._s(t.notebookName)+"\n        ")],1),n("q-btn",{attrs:{flat:"",icon:"more_horiz",color:"secondary",round:""}},[n("q-menu",{attrs:{anchor:"bottom right",self:"top right","content-class":"o-menu"}},[n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"schedule",label:t.$t("label.sortTime")},nativeOn:{click:function(e){return t.handleSortNote("time")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"sort_by_alpha",label:t.$t("label.sortTitle")},nativeOn:{click:function(e){return t.handleSortNote("title")}}}),n("q-separator"),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-folder-settings",label:t.$t("folder.detail")},nativeOn:{click:function(e){return t.notebookDetails(e)}}}),t.currentNotebook.id?n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"share",label:t.$t("action.share")},nativeOn:{click:function(e){return t.shareNotebook(e)}}}):t._e(),n("q-separator"),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",label:t.$t("action.close")},nativeOn:{click:function(e){return t.showNoteList(!1)}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:t.isPinned?"mdi-pin-off":"mdi-pin",label:t.isPinned?t.$t("action.unpin"):t.$t("action.pin")},nativeOn:{click:function(e){return t.togglePin(e)}}})],1)],1)],1),n("div",{staticClass:"row col-12 panel"},[n("div",{staticClass:"col"},[n("q-input",{ref:"term",staticClass:"col-12",attrs:{placeholder:""+t.$t("label.search"),debounce:"100",autofocus:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.term,callback:function(e){t.term=e},expression:"term"}})],1)])]),n("q-scroll-area",{ref:"tagsScroll",staticClass:"o-scroll-wrapper"},[n("q-list",{staticClass:"q-py-xs o-navi-list",attrs:{"no-border":"",link:"","inset-delimiter":""}},[t._l(t.noteList,(function(e,o){return n("q-item",{key:o,staticClass:"stripped",attrs:{dense:"",clickable:"",draggable:"true"},on:{dragstart:function(n){return t.onDragStart(n,e)}},nativeOn:{click:function(n){return t.onOpenNote(e)}}},[n("q-item-section",{attrs:{avatar:""}},[1===e.type?n("q-avatar",{attrs:{icon:"mdi-file-document-box"}}):n("q-avatar",{attrs:{icon:"mdi-markdown"}})],1),n("q-item-section",[t._v("\n            "+t._s(e.title)+"\n          ")]),1==e.star?n("q-item-section",{staticClass:"o-hover-toggle text-primary",attrs:{side:""},nativeOn:{click:function(n){return n.stopPropagation(),t.starNote(e,0)}}},[n("q-avatar",{attrs:{icon:"star"}}),n("q-tooltip",{staticClass:"o-tooltip",attrs:{anchor:"top middle",self:"bottom middle",offset:[0,8]}},[t._v("\n              "+t._s(t.$t("action.unstar"))+"\n            ")])],1):t._e(),1!=e.star?n("q-item-section",{staticClass:"o-hover-toggle text-primary",attrs:{side:""},nativeOn:{click:function(n){return n.stopPropagation(),t.starNote(e,1)}}},[n("q-avatar",{attrs:{icon:"star_border"}}),n("q-tooltip",{staticClass:"o-tooltip",attrs:{anchor:"top middle",self:"bottom middle",offset:[0,8]}},[t._v("\n              "+t._s(t.$t("action.star"))+"\n            ")])],1):t._e(),n("q-item-section",{staticClass:"o-hover-toggle text-red",attrs:{side:""},nativeOn:{click:function(n){return n.stopPropagation(),t.beforeDelete(e)}}},[n("q-avatar",{attrs:{icon:"close"}}),n("q-tooltip",{staticClass:"o-tooltip",attrs:{anchor:"top middle",self:"bottom middle",offset:[0,8]}},[t._v("\n              "+t._s(t.$t("action.remove"))+"\n            ")])],1)],1)})),0===t.noteList.length?n("div",{staticClass:"row justify-center text-blue-grey"},[t._v("\n          No Notes\n        ")]):t._e()],2)],1)],1),n("section",{class:t.contentClass},[n("o-editor-welcome",{directives:[{name:"show",rawName:"v-show",value:"welcome"===t.view,expression:"view==='welcome'"}]}),n("markdown-editor",{directives:[{name:"show",rawName:"v-show",value:"markdown"===t.view,expression:"view==='markdown'"}]}),n("note-editor",{directives:[{name:"show",rawName:"v-show",value:"note"===t.view,expression:"view==='note'"}]}),n("notebook-details",{directives:[{name:"show",rawName:"v-show",value:"notebook-details"===t.view,expression:"view==='notebook-details'"}]})],1)])},i=[],a=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("28a5"),n("7f7f"),n("c47a")),s=n.n(a),r=n("a026"),c=n("c28b"),l=n.n(c),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"row col-12 o-editor-welcome"},[n("header",{staticClass:"row col-12 justify-between items-center"},[n("div",[n("div",{staticClass:"name"},[t._v(t._s(t.$t("app.name")))]),n("div",{staticClass:"intro"},[t._v(t._s(t.$t("app.introduction")))])]),t._m(0)]),n("section",{staticClass:"row col-12 q-mt-md content"},[n("section",{staticClass:"row col-12 justify-center search-box"},[n("section",{staticClass:"col-10"},[n("o-note-search",{staticClass:"welcome-step-search"})],1)]),n("nav",{staticClass:"col-6"},[n("section",{staticClass:"col-12 panel-start welcome-step-start"},[n("h1",[t._v(t._s(t.$t("label.start")))]),n("div",[n("q-btn",{attrs:{color:"blue",icon:"post_add",label:t.$t("note.add"),dense:"",flat:""},on:{click:function(e){return t.newNote()}}})],1),n("div",[n("q-btn",{attrs:{color:"blue",icon:"mdi-markdown-outline",label:t.$t("note.markdown.add"),dense:"",flat:""},on:{click:function(e){return t.newMarkdown()}}})],1),n("div",[n("q-btn",{attrs:{color:"blue",icon:"reorder",label:t.$t("quicknote"),dense:"",flat:"",to:"/quicknote"}})],1),n("div",[n("q-btn",{attrs:{color:"blue",icon:"settings",label:t.$t("setting"),dense:"",flat:"",to:"/system/settings"}})],1)]),n("section",{staticClass:"row col-12 panel-recent"},[n("h1",[t._v(t._s(t.$t("note.recent")))]),n("div",{staticClass:"col-10"},[t.recentNotes.length>0?n("q-list",{staticClass:"list",attrs:{"no-border":"",link:"","inset-delimiter":""}},t._l(t.recentNotes,(function(e,o){return o<5?n("q-item",{key:o,staticClass:"text-blue",attrs:{clickable:""},nativeOn:{click:function(n){return t.openNote(e)}}},[n("q-item-section",{attrs:{side:""}},[1===e.type?n("q-icon",{staticClass:"text-blue",attrs:{name:"mdi-file-document-box-outline",size:"1.5rem"}}):n("q-icon",{staticClass:"text-blue",attrs:{name:"mdi-markdown-outline",size:"1.5rem"}})],1),n("q-item-section",[t._v(t._s(e.title))])],1):t._e()})),1):n("div",{staticClass:"q-px-md q-pt-sm text-grey"},[t._v("\n            暂无\n          ")])],1)]),n("section",{staticClass:"col-12 panel-start"},[n("h1",[t._v(t._s(t.$t("label.account")))]),t.isLogin?[n("div",[n("q-btn",{attrs:{color:"blue",icon:"person",label:t.$t("my"),dense:"",flat:"",to:"/my"}})],1),n("div",[n("q-btn",{attrs:{color:"blue",icon:"mdi-logout",label:t.$t("label.signout"),dense:"",flat:"",to:"/auth/signout"}})],1)]:[n("div",[n("q-btn",{attrs:{color:"green",icon:"person_add",label:t.$t("label.signup"),dense:"",flat:"",to:"/auth/signup"}})],1),n("div",[n("q-btn",{attrs:{color:"blue",icon:"mdi-login",label:t.$t("label.signin"),dense:"",flat:"",to:"/auth/signin"}})],1)]],2)]),n("nav",{staticClass:"col-6"},[t._e(),n("section",{staticClass:"panel-learn"},[n("h1",[t._v(t._s(t.$t("label.learn")))]),n("o-common-banner",{attrs:{icon:"mdi-markdown",label:t.$t("label.markdownguide"),"sub-label":t.$t("md.intro.guide"),to:"/system/markdown"}}),n("o-common-banner",{staticClass:"q-mt-md",attrs:{icon:"keyboard",label:t.$t("action.shortcut"),"sub-label":"Enhance the efficiency of edit",to:"/system/shortcut"}})],1),n("section",{staticClass:"panel-customize"},[n("h1",[t._v(t._s(t.$t("label.customize")))]),n("o-common-banner",{attrs:{icon:"palette",label:"Color Theme","sub-label":"Make the editor and your code look the way you love",to:"/system/settings"}}),n("o-common-banner",{staticClass:"q-mt-md",attrs:{icon:"settings",label:t.$t("label.setting"),"sub-label":"Preferred language, line number, etc.",to:"/system"}})],1),n("div",{staticClass:"col-12 panel-quick"},[n("h1",[t._v(t._s(t.$t("label.help")))]),n("div",{staticClass:"row"},t._l(t.languages,(function(e,o){return n("q-btn",{key:o,staticClass:"text-blue",class:t.locale===e.value?"active":"",attrs:{label:e.label,dense:"",flat:""},on:{click:function(n){return t.onLanguage(e)}}})})),1)]),t._e()])]),t._e()])},d=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("img",{attrs:{src:"statics/logo.png",width:"90"}})])}],m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-banner",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"relative-position bg-light cursor-pointer o-common-banner",attrs:{rounded:""},on:{click:function(e){return t.$router.push(t.to)}},scopedSlots:t._u([{key:"avatar",fn:function(){return[n("q-icon",{attrs:{name:t.icon,size:"2rem",color:"text"}})]},proxy:!0}])},[n("div",{staticClass:"o-text text-bold"},[t._v(t._s(t.label))]),n("div",{staticClass:"o-text-active"},[t._v(t._s(t.subLabel))])])},f=[],p={name:"o-common-banner",data:function(){return{}},props:{icon:{type:String,default:""},label:{type:String,default:""},subLabel:{type:String,default:""},to:{type:String,default:""}},methods:{},computed:{}},h=p,b=(n("9bea"),n("2877")),v=Object(b["a"])(h,m,f,!1,null,null,null),g=v.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-select",{staticClass:"o-note-search text-black",attrs:{placeholder:""+t.$t("label.search"),tabindex:"0",autofocus:"","use-input":"","hide-selected":"","input-debounce":"200",options:t.options,"hide-dropdown-icon":"","menu-offset":[0,8],rounded:"","popup-content-class":"o-search-popup",standout:"bg-light text-black"},on:{filter:t.filterFn,input:t.onSelected},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0},{key:"append",fn:function(){return[n("q-btn",{attrs:{icon:"mdi-microphone",flat:"",round:""}})]},proxy:!0},{key:"no-option",fn:function(){return[n("q-item",[n("q-item-section",{staticClass:"text-grey"},[t._v("\n        No results\n      ")])],1)]},proxy:!0},{key:"option",fn:function(e){return[e.opt.split?n("q-separator",{attrs:{color:"secondary"}}):t._e(),e.opt.value?n("q-item",t._g(t._b({attrs:{clickable:""}},"q-item",e.itemProps,!1),e.itemEvents),[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:e.opt.icon}})],1),n("q-item-section",{staticClass:"q-pl-md"},[t._v("\n        "+t._s(e.opt.label)+"\n      ")]),n("q-item-section",{attrs:{side:""}},[t._v("\n        "+t._s(t.timeMulti(e.opt.time).timestamp)+"\n      ")])],1):t._e()]}}]),model:{value:t.term,callback:function(e){t.term=e},expression:"term"}})},k=[],O=n("916d"),y=n("2f62"),C=n("b35e"),q=n("5809"),_=n("3ac3");function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={name:"o-note-search",mixins:[C["a"],q["a"],_["a"]],data:function(){return{term:"",showSearchResult:!1,options:[]}},components:{OCommonItem:O["a"]},methods:x({},Object(y["b"])({queryNote:"A_QUERY_NOTE"}),{onSearch:function(){this.showSearchResult=!0},onSelected:function(t){"notebook"===t.meta?this.openNotebook(t):this.openNote(t),this.term=""},formatNotes:function(t){return t.map((function(t){return{meta:"note",label:t.title,icon:1===t.type?"mdi-file-document-box":"mdi-markdown",stamp:"stamp",time:t.cedittime,value:t.id,id:t.id,split:t.split,type:t.type}}))},formatNotebooks:function(t){return t.map((function(t){return{meta:"notebook",label:t.name,icon:"folder",stamp:"stamp",time:t.cedittime,value:t.id,id:t.id,split:t.split,type:"notebook"}}))},fulltextSearchFilter:function(t){return function(e){var n=e.title||e.name,o=e.source||"",i=n.toLowerCase()+" "+o.toLowerCase(),a=i.indexOf(t.toLowerCase());return t.length>1?a>=0:0===a}},filterFn:function(t,e,n){var o=this;e((function(){var e=t?o.notebooks.filter(o.fulltextSearchFilter(t)):[],n=t?o.notes.filter(o.fulltextSearchFilter(t)):[];e.length>0&&n.length>0&&(n[0].split=1),o.options=o.formatNotebooks(e).concat(o.formatNotes(n))}))}}),computed:x({},Object(y["c"])({notes:"notes"})),mounted:function(){}},T=S,j=(n("c1c2"),Object(b["a"])(T,w,k,!1,null,null,null)),P=j.exports,$=n("6907");function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={name:"o-markdown-welcome",mixins:[C["a"],_["a"]],data:function(){return{value:"",languages:$["c"]}},computed:A({},Object(y["c"])({isProgress:"isProgress",notes:"openedNotes",recentNotes:"recentNotes",currentNote:"currentNote",myUid:"myUid"}),{currentNoteId:function(){return this.currentNote.id}}),methods:A({},Object(y["b"])({A_QUERY_RECENT_NOTE:"A_QUERY_RECENT_NOTE",setSettingItem:"A_SET_SETTING_ITEM"}),{onClickTab:function(t){this.$router.push({name:"note",params:{id:t}})},onClose:function(t){this.$store.commit("CLOSE_NOTE",t),t===this.currentNoteId&&this.notes.length>0&&(t=this.notes[0].id,this.$router.push({name:"note",params:{id:t}}))},onLanguage:function(t){this.$i18n.locale=t.value,this.setSettingItem({key:"locale",value:t.value})}}),watch:{currentNoteId:function(t,e){this.value=t}},mounted:function(){this.A_QUERY_RECENT_NOTE()},components:{OCommonBanner:g,ONoteSearch:P}},M=L,D=(n("66ce"),Object(b["a"])(M,u,d,!1,null,null,null)),I=D.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("split-pane",{staticClass:"component-editor ",attrs:{"min-percent":0,defaultPercent:t.leftPanePercent,split:"vertical"},on:{resize:t.onResize},nativeOn:{paste:function(e){return t.onPaste(e)}}},[n("template",{slot:"paneL"},[n("section",{attrs:{id:"editor"}},[n("section",{staticClass:"component-code content-container markdown-step-editor",on:{mouseenter:function(e){return t.onMouseEnter("editor")},mouseleave:function(e){return t.onMouseLeave("editor")}}},[n("codemirror",{ref:"codemirror",staticClass:"editor",attrs:{id:"codemirror",options:t.editorOption,hint:!0},on:{input:t.onEditorChanged,scroll:t.onEditorScroll},model:{value:t.source,callback:function(e){t.source=e},expression:"source"}})],1)])]),n("template",{slot:"paneR"},[n("section",{staticClass:"preview",on:{mouseenter:function(e){return t.onMouseEnter("preview")},mouseleave:function(e){return t.onMouseLeave("preview")}}},[t.printable?n("section",[n("article",{staticStyle:{padding:"0 10px"}},[n("vue-markdown",{attrs:{source:t.source,postTocRender:t.postTocRender,tocFirstLevel:2}})],1)]):n("section",{staticClass:"component-preview content-container markdown-step-preview"},[n("q-scroll-area",{ref:"previewScroll",staticStyle:{width:"100%",height:"100%"}},[n("q-scroll-observer",{on:{scroll:t.onPreviewScroll}}),n("article",{staticStyle:{padding:"0 10px"},attrs:{id:"markdown-preview"}},[n("vue-markdown",{attrs:{source:t.source,postTocRender:t.postTocRender,tocFirstLevel:2}})],1)],1)],1)]),n("section",[n("markdown-side-panel",{attrs:{show:t.sidePanel},on:{show:t.onSidePanelShow,close:t.onSidePanelClose}}),n("o-file-upload",{attrs:{title:t.$t("action.upload"),contentCss:{padding:"20px",height:"60vh",width:"50vw"},show:t.modal.uploader,file:t.pasteFile},on:{close:function(e){return t.onModalClose("uploader")},uploaded:t.onFileUploaded}})],1)])],2)},Q=[],U=(n("ac4d"),n("b54a"),n("48c0"),n("8f94")),F=(n("1ef7"),n("31c5"),n("a7be"),n("7393"),n("0109"),n("d2e8"),n("ed9c"),n("4659"),n("01cb"),n("eb8f"),n("bbca"),n("d5db"),n("959b"),n("5f53"),n("9a48"),n("0920")),H=n("8a60"),B=n.n(H),z=n("640f"),K=n("ce81"),G=n("5777"),Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-dialog",{ref:"modal",staticClass:"sidePanel",attrs:{position:"right",maximized:"",seamless:"",square:"","content-class":"markdown-side-panel"},on:{show:function(e){return t.$emit("show")},hide:function(e){return t.$emit("close")}}},[n("q-layout",{staticClass:"bg-secondary markdown-step-side-panel",staticStyle:{width:"50%","min-width":"400px"},attrs:{view:"lhh lpR fff"}},[n("q-header",{staticClass:"bg-secondary"},[n("q-toolbar",[n("q-toolbar-title",[n("section",{staticClass:"row col-12"},[n("q-tabs",{ref:"tabs",staticClass:"bg-secondary text-text-active",attrs:{align:"left","inline-label":""},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},t._l(t.tabs,(function(t,e){return n("q-tab",{key:e,attrs:{name:t.value,label:t.label}})})),1)],1)]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-text",attrs:{icon:"close",flat:"",round:"",dense:""}})],1)],1),n("q-page-container",[n("q-page",[n("section",{staticClass:"content-container themed"},[n("section",{directives:[{name:"show",rawName:"v-show",value:"basic"==t.currentTab,expression:"currentTab=='basic'"}],staticClass:"col-12"},[n("q-list",{attrs:{"no-border":"",link:"","inset-delimiter":""}},[n("q-item-label",{staticClass:"text-uppercase text-blue-grey-5 q-pa-md"},[t._v(t._s(t.$t("label.shareExport")))]),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"share",label:t.$t("action.share"),"side-label":"Ctrl+Shift+S"},nativeOn:{click:function(e){return t.onAction("action-share")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-file-pdf-box",label:t.$t("action.pdf"),"side-label":"Ctrl+P"},nativeOn:{click:function(e){return t.onAction("action-export")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-markdown",label:t.$t("action.exportMd")},nativeOn:{click:function(e){return t.onAction("action-export-md")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-language-html5",label:t.$t("action.exportHtml")},nativeOn:{click:function(e){return t.onAction("action-export-html")}}})],1),n("q-list",{attrs:{"no-border":"",link:"","inset-delimiter":""}},[n("q-item-label",{staticClass:"text-uppercase text-blue-grey-5 q-pa-md"},[t._v(t._s(t.$t("label.help")))]),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-tooltip-text",label:t.$t("tour")},nativeOn:{click:function(e){return t.action("M_SET_TOUR_ACTION","markdown")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-keyboard",label:t.$t("action.shortcut")},nativeOn:{click:function(e){return t.onAction("action-shortcut")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-markdown",label:t.$t("label.markdownguide")},nativeOn:{click:function(e){return t.onAction("action-guide")}}})],1),n("div",{staticClass:"settings"},[n("q-item-label",{staticClass:"text-uppercase text-blue-grey-5 q-pa-md"},[t._v(t._s(t.$t("label.setting")))]),n("div",{staticClass:"q-px-md"},[n("o-ui-theme-select",{on:{input:function(e){return t.onSettingChange(e,"uiTheme")}},model:{value:t.setting.uiTheme,callback:function(e){t.$set(t.setting,"uiTheme",e)},expression:"setting.uiTheme"}}),n("o-syntax-theme-select",{on:{input:function(e){return t.onSettingChange(e,"syntaxTheme")}},model:{value:t.setting.syntaxTheme,callback:function(e){t.$set(t.setting,"syntaxTheme",e)},expression:"setting.syntaxTheme"}}),n("q-field",{attrs:{standout:"bg-secondary"},scopedSlots:t._u([{key:"before",fn:function(){return[n("q-icon",{attrs:{name:"view_headline"}})]},proxy:!0}])},[n("q-toggle",{staticClass:"text-text",attrs:{color:"primary",label:t.$t("label.isLineNumber")},on:{input:function(e){return t.onSettingChange(e,"isLineNumber")}},model:{value:t.setting.isLineNumber,callback:function(e){t.$set(t.setting,"isLineNumber",e)},expression:"setting.isLineNumber"}})],1),n("q-field",{attrs:{standout:"bg-secondary"},scopedSlots:t._u([{key:"before",fn:function(){return[n("q-icon",{attrs:{name:"tab"}})]},proxy:!0}])},[n("q-toggle",{staticClass:"text-text",attrs:{color:"primary",label:t.$t("label.noteTab")},on:{input:function(e){return t.onSettingChange(e,"noteTab")}},model:{value:t.setting.noteTab,callback:function(e){t.$set(t.setting,"noteTab",e)},expression:"setting.noteTab"}})],1)],1)],1)],1),n("section",{directives:[{name:"show",rawName:"v-show",value:"toc"==t.currentTab,expression:"currentTab=='toc'"}],staticClass:"full-width full-height"},[n("q-scroll-area",{ref:"tocScroll",staticStyle:{width:"100%",height:"100%"}},[n("q-tree",{ref:"tocTree",staticClass:"themed",attrs:{nodes:t.tocTree,selected:t.selectedTocItem,"node-key":"key","default-expand-all":"",color:"text",id:"tocTree","no-connectors":""},on:{"update:selected":function(e){t.selectedTocItem=e}},nativeOn:{click:function(e){return t.onTocClick()}},scopedSlots:t._u([{key:"header-heading",fn:function(e){return n("div",{staticClass:"row items-center",attrs:{"data-source-line":e.node.heading.lineNumber}},[n("div",{},[t._v(t._s(e.node.label))])])}}])})],1)],1),n("section",{directives:[{name:"show",rawName:"v-show",value:"qnote"===t.currentTab,expression:"currentTab==='qnote'"}],staticClass:"panel"},[n("header",[t.currentNote.qtag?n("section",{staticClass:"row col-12 justify-between items-center text-text-active"},[n("div",[t._v("已关联快速笔记")]),n("div",[n("q-btn",{attrs:{label:"单独查看",color:"text-active",to:"/quicknote/tag/"+t.currentNote.qtag,flat:""}}),n("q-btn",{attrs:{label:"更改关联",color:"text-active",flat:""},on:{click:function(e){return t.showQtag(!0)}}})],1)]):n("section",{staticClass:"row col-12 justify-between items-center"},[n("div",{staticClass:"text-text"},[t._v("未关联快速笔记")]),n("div",[n("q-btn",{attrs:{label:"去关联",color:"text-active",flat:""},on:{click:function(e){return t.showQtag(!0)}}})],1)])]),n("section",{staticClass:"bg-white qnote-container"},[t.currentNote.qtag?n("section",[n("note-quicknote",{attrs:{id:t.qtag}})],1):n("section",{staticClass:"q-pa-md"},[t._v("\n                快速笔记可以帮助您：\n                "),n("ul",[n("li",[t._v("提供写作的上下文环境")]),n("li",[t._v("收集零散知识")])])])])]),n("section",{directives:[{name:"show",rawName:"v-show",value:"history"===t.currentTab,expression:"currentTab==='history'"}]},[n("section",{staticClass:"row col-12 q-pa-md justify-center"},[t._v("\n              敬请期待！\n            ")])])]),n("section",[n("o-common-dialog",{attrs:{title:t.$t("action.move"),icon:"swap_vert",show:t.showQtagDialog},on:{show:t.onQtagShow,close:t.onQtagClose,confirm:t.onQtagConfirm}},[n("template",{slot:"content"},[n("section",{staticClass:"relative-position"},[n("o-qtag-select",{on:{input:t.onQtagSelect}})],1)])],2)],1)])],1)],1)],1)},W=[],J=n("625b"),V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"row col-12 full-width o-qtag-select"},[n("header",{staticClass:"row col-12 justify-between"},[n("div",[n("q-icon",{attrs:{name:"bookmark",size:"1.2rem"}}),t._v("\n      "+t._s(t.qtag.name)+"\n    ")],1),n("div",[t._v("\n      关联到: "+t._s(t.moveToQtag.label)+"\n    ")]),n("q-input",{ref:"filter",staticClass:"col-12 q-mt-sm",attrs:{filled:"",label:t.$t("search")},scopedSlots:t._u([{key:"append",fn:function(){return[""!==t.filter?n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:t.resetFilter}}):t._e()]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1),n("section",{staticClass:"col-12 text-black shadow-0 relative-position",staticStyle:{height:"300px"}},[n("q-scroll-area",{staticClass:"content-scroll-area"},[n("q-tree",{ref:"qtagTree",staticClass:"o-tree notebook-tree",attrs:{nodes:t.qtagTree,"node-key":"key","default-expand-all":"",selected:t.selected,filter:t.filter,"filter-method":t.myFilterMethod,color:"grey-5"},on:{"update:selected":function(e){t.selected=e}},scopedSlots:t._u([{key:"default-header",fn:function(e){return[n("section",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"row justify-between items-center full-width cursor-pointer",on:{click:function(n){return t.onQtagClick(e.node)}}},[n("section",{staticClass:"row col-12 justify-between"},[n("div",[n("q-icon",{attrs:{name:e.node.icon}}),t._v(t._s(e.node.label))],1)])])]}}])})],1)],1)])},X=[],Z=n("e0c54");function tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nt={name:"o-qtag-select",mixins:[Z["a"]],data:function(){return{filter:"",selected:"",moveToQtag:{}}},props:{qtag:{type:Object,default:function(){return{}}}},methods:et({},Object(y["b"])({}),{onQtagClick:function(t){console.log("onQtagClick",t,this.selected),this.moveToQtag=t,this.$emit("input",t)},myFilterMethod:function(t,e){var n=e.toLowerCase();return t.label&&t.label.toLowerCase().indexOf(n)>-1},resetFilter:function(){this.filter="",this.$refs.filter.focus()}}),computed:et({},Object(y["c"])({}),{qtagTree:function(){var t=this,e=this.topQtags.filter(this.excludeQtag(this.qtag.id)).map((function(e){return{key:e.id,label:e.name,header:"root",icon:"folder",data:e,children:t.getChildNodes(e.id,t.qtag.id)}}));return this.qtag.parent&&e.unshift({key:"top",label:"Top",header:"root",icon:"filter_vintage"}),e}}),watch:{}},ot=nt,it=(n("49ee"),Object(b["a"])(ot,V,X,!1,null,null,null)),at=it.exports,st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"note-quicknote row",on:{paste:function(e){return e.stopPropagation(),t.onPaste(e)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticClass:"topProgress"},[n("div",{staticClass:"progress-bg bg-primary"}),n("div",{staticClass:"progress-text"},[n("span",{staticClass:"text-primary"},[t._v(t._s(t.$t("label.refresh")))]),n("q-spinner",{staticStyle:{"margin-left":"1rem"},attrs:{color:"primary",size:36}})],1)]),n("q-scroll-area",{ref:"qnoteScroll",staticClass:"quicknote-wrapper"},[n("q-scroll-observer",{on:{scroll:t.onScroll}}),n("div",{staticClass:"o-cards-wrapper col-12 preview"},["list"==t.view?n("div",{staticClass:"o-qnote-list ",on:{paste:function(e){return e.stopPropagation(),t.onPaste(e)}}},[t.qnoteMap.length>0?n("q-list",{ref:"micle",attrs:{"no-border":""}},[t._l(t.qnoteMap,(function(e,o){return[n("q-item",{key:o,staticClass:"qnote-starter"},[n("div",{staticClass:"o-date-divider"},[n("hr"),n("div",{staticClass:"o-date-wrapper"},[n("span",[t._v(t._s(e.date))])])])]),t._l(e.list,(function(e){return n("q-item",{key:e.id,staticClass:"qnote-item",attrs:{id:e.id,multiline:""}},[t._e(),n("q-item-section",[n("q-item-label",{staticClass:"o-qnote-time"},[n("section",{staticClass:"row col-12 justify-between items-center"},[n("section",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"row justify-center items-center relative-position action",class:"bg-"+t.colorName(e)+" text-white",attrs:{color:t.colorName(e)}},[n("q-icon",{attrs:{name:t.typeClass(e.type)}}),n("q-menu",{ref:"menuPopover",refInFor:!0,staticClass:"shadow-1",attrs:{anchor:"bottom left",self:"top left"}},[n("div",{staticStyle:{"min-width":"200px"}},[n("o-qnote-menu",{attrs:{data:e},on:{edit:t.editQNote,remove:t.beforeDelete,card:t.generateCard,mark:t.markQNote}})],1)])],1),n("div",[n("span",[t._v(t._s(t._f("formatTime")(e.addtime,"{h}:{i}"))+"\n                        "),n("q-tooltip",{staticClass:"o-tooltip",attrs:{anchor:"top middle",self:"bottom left",offset:[0,8]}},[t._v("\n                          "+t._s(e.addtime)+"\n                        ")])],1)])])]),n("q-item-label",["IMAGE"===t.typeText(e.type)?n("section",{staticClass:"type-image"},[n("img",{attrs:{src:e.url,alt:e.text,title:e.text}})]):"VIDEO"===t.typeText(e.type)?n("section",{staticClass:"type-video"},[n("video",{attrs:{src:e.url,controls:"controls",width:"100%",height:"90%"}})]):"FILE"===t.typeText(e.type)?n("section",{staticClass:"type-link"},[n("a",{attrs:{href:e.url,download:"File"}},[n("q-icon",{attrs:{name:"attachment",size:"36px"}}),n("span",[t._v("File Attachment")])],1)]):n("section",{domProps:{innerHTML:t._s(t.renderMarkdown(e.text))}}),e.attachment.type?n("section",{staticClass:"attachment"},[n("header",[t._v(t._s(e.attachment.title))]),n("section",{staticClass:"row col-12 q-mt-sm"},[n("div",{staticClass:"col-auto"},[n("img",{attrs:{src:e.attachment.thumb}})]),n("div",{staticClass:"col-12 text-grey desc"},[n("div",[t._v(t._s(e.attachment.description))]),n("div",{staticClass:"q-mt-sm"},[t._v(t._s(e.attachment.content)+" ...")])])])]):t._e()])],1)],1)}))]}))],2):n("section",{staticClass:"row justify-center q-mt-xl"},[t._v("\n          No more data\n        ")])],1):t._e()])],1),n("section",{staticClass:"quicknote-editor"},[n("div",{staticClass:"toolbar"},[n("q-btn",{attrs:{icon:"attachment",flat:""}},[n("input",{staticClass:"o-input-file",attrs:{type:"file"},on:{change:t.onFileChanged}}),n("q-tooltip",{staticClass:"o-tooltip",attrs:{anchor:"top middle",self:"bottom middle",offset:[0,8]}},[t._v("\n          "+t._s(t.$t("action.upload.file"))+"\n        ")])],1),n("q-btn",{attrs:{icon:"add",flat:""}},[n("q-tooltip",{staticClass:"o-tooltip",attrs:{anchor:"top middle",self:"bottom middle",offset:[0,8]}},[t._v("\n          "+t._s(t.$t("action.add"))+"\n        ")])],1)],1),n("div",{staticClass:"editor"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{id:"editor",tabindex:"1",placeholder:t.$t("label.sendnote"),rows:"4",autofocus:!0},domProps:{value:t.text},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),t.onSubmit(e))},paste:function(e){return e.stopPropagation(),t.onPasteInEditor(e)},input:function(e){e.target.composing||(t.text=e.target.value)}}})])]),n("section",[n("o-file-upload",{attrs:{title:t.$t("action.upload"),contentCss:{padding:"20px",minHeight:"60vh",minWidth:"50vw"},show:t.showUploader,file:t.file},on:{close:function(e){t.showUploader=!1},uploaded:t.onFileUploaded}}),n("o-side-dialog",{attrs:{title:"Quick Note","content-class":"qnote-editor",contentStyle:{width:"600px"},show:t.showSideDialog,actionVisible:!0},on:{show:t.onSideDialogOpen,close:function(e){t.showSideDialog=!1},confirm:t.update}},[n("template",{slot:"content"},[n("section",{staticClass:"row col-12 justify-center items-center"},[n("section",{staticClass:"col-12"},[n("qnote-markdown-editor",{attrs:{id:t.qnote.id},model:{value:t.qnote.text,callback:function(e){t.$set(t.qnote,"text",e)},expression:"qnote.text"}})],1),n("section",{staticClass:"col-12 q-py-md meta"},[n("q-select",{attrs:{options:t.qtagOptions,label:t.$t("label.qtag"),"use-input":"","input-debounce":"0",filled:"","map-options":"","emit-value":""},on:{filter:t.filterFn},scopedSlots:t._u([{key:"before",fn:function(){return[n("q-icon",{attrs:{name:"bookmark"}})]},proxy:!0}]),model:{value:t.qnote.qtag,callback:function(e){t.$set(t.qnote,"qtag",e)},expression:"qnote.qtag"}}),n("q-field",{attrs:{borderless:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"access_time"}})]},proxy:!0},{key:"control",fn:function(){return[n("div",{attrs:{tabindex:"0"}},[t._v(t._s(t.qnote.addtime))])]},proxy:!0}])})],1)])])],2),n("o-side-dialog",{attrs:{title:"生成卡片","content-class":"qnote-card",contentStyle:{width:"375px"},show:t.showCard,actionVisible:!1,"confirm-label":"下载"},on:{show:t.onPrepareCard,close:function(e){t.showCard=!1,t.cardImg=""},confirm:t.onDownloadCard}},[n("template",{slot:"content"},[n("q-scroll-area",{staticClass:"scroll-area-content"},[t.cardImg?n("section",{staticClass:"image"},[n("img",{attrs:{src:t.cardImg}})]):n("section",{staticClass:"full-height snapshot preview"},[t.cardData.text?n("section",{staticClass:"qnote-container",domProps:{innerHTML:t._s(t.renderMarkdown(t.cardData.text))}}):t._e(),n("section",{staticClass:"row col-12 justify-center q-pa-md logo"},[n("img",{attrs:{src:"statics/logo.png",height:"20"}}),n("span",{staticClass:"q-ml-xs text-grey"},[t._v(t._s(t.$t("app.name")))])])])])],1),n("template",{slot:"actions"},[n("q-btn",{staticClass:"col-6",attrs:{color:"primary",label:"下载",loading:t.cardLoading},on:{click:t.onDownloadCard}})],1)],2)],1)],1)},rt=[],ct=(n("551c"),n("fbe4")),lt=n("f94c"),ut=n("92a8"),dt=n("787d"),mt=n("5822"),ft=n("ed08"),pt=n("a43c"),ht=n("31d6"),bt=n("5f87");function vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wt={name:"note-quicknote",mixins:[ht["a"]],data:function(){return{view:"list",qtagNeedle:""}},props:{id:{type:String,default:""}},components:{BaseToolbar:ct["a"],OCommonModal:lt["a"],OFileUpload:G["a"],OQnoteMenu:ut["a"],OSideDialog:dt["a"],QnoteMarkdownEditor:mt["a"]},filters:{formatTime:function(t,e){return Object(ft["a"])(t,e)}},methods:{handleAction:function(t){switch(t){case"view-list":this.view="list";break;case"view-card":this.view="card";break;case"action-paste":this.onPasteContent();break}},queryQNote:function(t){var e=this;return new Promise((function(n,o){var i=[],a={operation:"",pagesize:50,index:0,condition:{uid:Object(bt["e"])(),qtag:e.qtag}};"refresh"===t?(a.operation="2",a.index=e.pageIndex):(a.operation="0",e.pullable=!0,e.quicknotes=[]),"all"===e.qtag&&(a.condition.qtag=""),e.pullable?Object(pt["d"])(a).then((function(o){o.data.length>0?(i=o.data.sort(e.sortQNoteByIndex),"refresh"===t&&(i=i.concat(e.quicknotes)),e.quicknotes=i,e.pullable=!0,e.pageIndex=i[0].index):e.pullable=!1,n(i)})).catch((function(t){o(t)})):n(i)}))},loadQNotes:function(t){var e=this,n="latest"===t?0:this.scrollHeight();this.showProgress=!0,this.queryQNote(t).then((function(t){e.showProgress=!1;var o=e;r["a"].nextTick((function(){if(t&&t.length>0){var e=o.scrollHeight();o.$store.commit("SET_QNOTE_TOPID");var i=e-n;i<=0&&(i=100),o.scrollTo(i)}o.groupByDate(o.qnoteList)}))})).catch((function(t){e.showProgress=!1,console.warn(t.message)}))},onScroll:function(t){var e=this;this.isScrolled&&0===t.position&&"up"===t.direction&&(this.showProgress=!0,setTimeout((function(){e.loadQNotes("refresh")}),1e3)),this.isScrolled=!0},onRoute:function(t){this.isScrolled=!1,"qtag"===t.name&&(this.qtag=this.currentQTag.id,this.loadQNotes("latest"))}},computed:gt({},Object(y["c"])({}),{qnoteList:function(){return this.quicknotes.filter(this.filterQTag).filter(this.filterColor).filter(this.filterSearch)},qnoteMap:function(){return this.groupByDate(this.qnoteList)}}),watch:{$route:function(t,e){this.onRoute(t)},id:function(t,e){this.qtag=this.id,this.loadQNotes("latest")},qnoteAction:function(t,e){var n,o,i=t.split("|");i.length>=1&&(n=i[1]),i.length>=2&&(o=i[2]),this.handleAction(n,o)}},mounted:function(){var t=this;setTimeout((function(){t.qtag=t.id,t.loadQNotes("latest")}),200)}},kt=wt,Ot=(n("e076"),Object(b["a"])(kt,st,rt,!1,null,null,null)),yt=Ot.exports,Ct=n("4f1d"),qt=n("28f3"),_t=n("f5a7");function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St={name:"markdown-side-panel",mixins:[C["a"],_t["a"]],data:function(){return{currentTab:"basic",showQtagDialog:!1,qtag:"",selectedQtag:"",selectedTocItem:""}},props:{show:{type:Boolean,default:!1}},components:{OCommonDialog:J["a"],OCommonItem:O["a"],OQtagSelect:at,NoteQuicknote:yt,OUiThemeSelect:Ct["a"],OSyntaxThemeSelect:qt["a"]},computed:xt({},Object(y["c"])({currentNote:"currentNote",tocTree:"toc",setting:"setting"}),{tabs:function(){return[{label:this.$t("label.basic"),value:"basic",icon:"info"},{label:this.$t("label.toc"),value:"toc",icon:"format_align_justify"},{label:this.$t("quicknote"),value:"qnote",icon:"reorder"},{label:"历史记录",value:"history",icon:"timer"}]},currentNoteId:function(){return this.currentNote.id}}),methods:xt({},Object(y["b"])({UpdateNote:"UpdateNote",setSettingItem:"A_SET_SETTING_ITEM"}),{onAction:function(t,e){t=(new Date).getTime()+"|"+t,e&&(t+="|"+e),this.$store.commit("setNoteAction",t)},onTabChanged:function(){},onSettingChange:function(t,e){switch(e){case"uiTheme":this.setTheme(t,!1);break}this.setSettingItem({key:e,value:t})},onTocClick:function(){this.selectedTocItem&&this.onAction("markdown-toc-line",this.selectedTocItem)},showQtag:function(t){this.showQtagDialog=t},onQtagShow:function(){this.selectedQtag=""},onQtagClose:function(){this.showQtag(!1)},onQtagConfirm:function(){if(this.selectedQtag){var t={id:this.currentNote.id,qtag:this.selectedQtag};console.log("save qtag",t),this.UpdateNote(t),this.qtag=this.selectedQtag}},onQtagSelect:function(t){this.selectedQtag=t.key},onRoute:function(t,e){}}),watch:{$route:function(t,e){this.onRoute(t,e)},show:function(t,e){t?(this.qtag=this.currentNote.qtag||"",this.$refs.modal.show()):this.$refs.modal.hide()},currentNoteId:function(t,e){this.qtag=this.currentNote.qtag||""}},mounted:function(){this.show&&this.$refs.modal.show()}},Tt=St,jt=(n("bc97"),Object(b["a"])(Tt,Y,W,!1,null,null,null)),Pt=jt.exports,$t=n("7fcb"),Et=n("097f"),At=n("8f85"),Lt=n("dcc5"),Mt=n("3ba6");function Dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}r["a"].use(F["a"]);var Rt=null,Qt=!1,Ut={name:"markdown-editor",mixins:[C["a"],Lt["a"],Mt["a"]],data:function(){return{id:"",notebook:"default",source:"# New Markdown",editorOption:{tabSize:4,mode:{name:"markdown",json:!0},theme:"freshcut",line:!0,lineWrapping:!0,lineNumbers:!0,keyMap:"sublime",extraKeys:{Enter:"newlineAndIndentContinueMarkdownList","Ctrl-F":function(){Rt.action("action-find")},"Cmd-F":function(){Rt.action("action-find")},"Shift-Ctrl-S":function(){Rt.action("action-share")},"Shift-Cmd-S":function(){Rt.action("action-share")},"Shift-Ctrl-P":function(){Rt.action("markdown-control-panel")},"Shift-Cmd-P":function(){Rt.action("markdown-control-panel")},"Ctrl-S":function(){Rt.save()},"Cmd-S":function(){Rt.save()},"Ctrl-B":function(){Rt.action("format-bold")},"Cmd-B":function(){Rt.action("format-bold")},"Ctrl-I":function(){Rt.action("format-italic")},"Cmd-I":function(){Rt.action("format-italic")},"Ctrl-Q":function(){Rt.quote()},"Ctrl-K":function(){Rt.code()},"Cmd-K":function(){Rt.code()},"Ctrl-L":function(){Rt.action("action-link")},"Cmd-L":function(){Rt.action("action-link")},"Ctrl-G":function(){Rt.action("action-picture")},"Cmd-G":function(){Rt.action("action-picture")},"Ctrl-R":function(){Rt.horizontal()},"Cmd-R":function(){Rt.horizontal()},"Ctrl-P":function(){Rt.print()},"Cmd-P":function(){Rt.print()},"Ctrl-Enter":function(){Rt.onAction("action-view")},"Cmd-Enter":function(){Rt.onAction("action-view")}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],styleActiveLine:!0,styleSelectedText:!0,scrollbarStyle:"native",tabindex:1,autofocus:!1},view:"live",leftPanePercent:50,currentLineNumber:1,isEditorScroll:!0,isPreviewScroll:!1,modal:{uploader:!1},selected:"",pasteFile:{},printable:!1,isNew:!1,isLoading:!1,sidePanel:!1}},components:{codemirror:U["codemirror"],CodeMirror:U["CodeMirror"],SplitPane:z["a"],OMedia:K["a"],OFileUpload:G["a"],MarkdownSidePanel:Pt},computed:It({},Object(y["c"])({isMobile:"isMobile",currentNotebookId:"currentNotebookId",setting:"setting",toc:"toc",currentMedia:"currentMedia",currentNote:"currentNote",openedNotes:"openedNotes"}),{tocTree:function(){return r["a"].nextTick((function(){})),this.toc},lineNumber:function(){return this.setting.isLineNumber},syntaxTheme:function(){return this.setting.syntaxTheme},cm:function(){return this.$refs.codemirror.codemirror},noteAction:function(){return this.$store.state.note.action},revision:function(){return this.currentNote.revision}}),methods:It({},Object(y["b"])({SaveNote:"SaveNote",GetNoteLine:"GetNoteLine",SetNoteLine:"SetNoteLine",A_QUERY_RECENT_NOTE:"A_QUERY_RECENT_NOTE"}),{refreshEditor:function(){var t=this;setTimeout((function(){t.cm.refresh(),t.cm.focus()}),10)},create:function(){var t=this;if("New Markdown"===this.currentNote.title)this.loadNote(this.currentNote.id),this.$router.push({name:"markdown_new"});else{this.isNew=!0,this.source="# New Markdown",this.notebook="",this.id="";var e=this;this.$nextTick((function(){t.save((function(t){e.openNote(t),e.isNew=!1,e.$router.push({name:"markdown",params:{id:t.id}})}),!1)}))}},save:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Rt.cm.doc.getValue();if(o){var i=this.id?this.id:Object(ft["b"])(),a=this.notebook?this.notebook:this.currentNotebookId;this.SaveNote({id:i,notebook:a,draft:o,state:0,isSync:n}).then((function(o){n&&(e.id?e.notifySuccess(e.$t("note.tip.synced"),0,"top"):e.notifyInfo(e.$t("note.tip.created"),0,"top")),e.postLoadNote(o),e.openNote(o),t&&t(o)})).catch((function(t){t.message.indexOf("Cancel")>=0?Object(At["a"])({type:"auth-tips",tips:"同步可以将笔记内容保存在云端",icon:"mdi-cloud-sync"}):console.log(t)}))}},remove:function(){this.id="",this.source="",this.notebook=""},loadNote:function(t){var e=this;this.isLoading=!0,Object($t["a"])(t).then((function(n){1!==n.type&&(e.notebook=n.notebook,e.source=n.draft,e.postLoadNote(n),e.openNote(n),e.$nextTick((function(){e.restoreScroll(t),e.isLoading=!1})))}))},restoreScroll:function(t){var e=this;this.GetNoteLine(t).then((function(t){t&&e.scrollToLine(t,!0),e.isEditorScroll=!0,e.isPreviewScroll=!1}))},postLoadNote:function(t){this.id=t.id,this.cacheNote(t.id),this.$store.commit("SET_CURRENT_NOTE",t),this.A_QUERY_RECENT_NOTE(),t.title&&(document.title="Donote | "+t.title)},openNote:function(t){this.refreshEditor(),this.$store.commit("OPEN_NOTE",t)},cacheNote:function(t){localStorage.setItem("LAST_NOTE",t)},handleRoute:function(t,e){var n=t.name,o=t.params.id;"markdown"===n||"editor"===n?(!o&&this.openedNotes.length>0&&(o=localStorage.getItem("LAST_NOTE")),o&&this.loadNote(o)):this.showSidePanel(!1)},bindActions:function(){B.a.bind(["command+s","ctrl+s"],(function(){return Rt.onAction("action-save")})),B.a.bind(["command+f","ctrl+f"],(function(){return Rt.onAction("action-find")})),B.a.bind(["command+shift+s","ctrl+shift+s"],(function(){return Rt.onAction("action-share")})),B.a.bind(["command+p","ctrl+p"],(function(){return Rt.onAction("action-print")})),B.a.bind(["command+enter","ctrl+enter"],(function(){return Rt.onAction("action-view")})),B.a.bind(["command+shift+p","ctrl+shift+p"],(function(){return Rt.onAction("markdown-control-panel")}))},action:function(t){t=(new Date).getTime()+"|"+t,Rt.$store.commit("setNoteAction",t)},onAction:function(t,e){switch(t){case"action-view":"edit"===this.view?this.onAction("view-live"):"live"===this.view?this.onAction("view-preview"):this.onAction("view-edit");break;case"view-edit":this.leftPanePercent=100,this.view="edit";break;case"view-live":var n=(new Date).getTime(),o=n/999999999999999;this.leftPanePercent=50+o,this.view="live";break;case"view-preview":this.leftPanePercent=0,this.view="preview";break;case"action-select-all":this.selectAll();break;case"action-find":break;case"action-add":this.create();break;case"action-remove":this.remove();break;case"action-save":this.save();break;case"action-share":this.share();break;case"action-print":case"action-export":this.print();break;case"action-export-md":Object(Et["c"])();break;case"action-export-html":Object(Et["a"])();break;case"action-shortcut":this.shortcut();break;case"action-guide":this.$router.push("/system/markdown");break;case"action-faq":break;case"action-about":this.$router.push("/system/about");break;case"format-bold":this.bold(this.cm);break;case"format-italic":this.italic();break;case"format-quote":this.quote();break;case"format-list":this.bulleted();break;case"format-code":this.code();break;case"format-link":this.link(e);break;case"format-picture":this.picture(e);break;case"format-table":this.table();break;case"format-horizontal":this.horizontal();break;case"format-media":Object(At["a"])({type:"media"});break;case"action-media":this.mediaSelected();break;case"markdown-side-panel":this.showSidePanel(!0);break;case"markdown-side-panel-off":this.showSidePanel(!1);break;case"markdown-toc-line":this.selected=e,this.onTocClick();break;case"markdown-formula":this.formula(e);break;case"markdown-diagram":this.diagram(e);break;case"markdown-control-panel":Object(At["a"])({type:"control-panel",data:{panel:"markdown"}});break}return!1},share:function(){this.isLogin?Object(At["a"])({type:"share",content:"note"}):Object(At["a"])({type:"auth-tips",tips:"分享可以通过链接把笔记分享给好友",color:"purple",icon:"share"})},print:function(){var t=this;setTimeout((function(){t.printable=!0,t.$nextTick((function(){window.print(),t.printable=!1}))}),1e3)},shortcut:function(){Object(At["a"])({type:"shortcut"})},mediaSelected:function(){var t=this.currentMedia.type,e=this.currentMedia.url,n=this.currentMedia.name;this.onMediaSelected(t,e,n)},onMediaSelected:function(t,e,n){switch(t){case 1:this.picture(e,n);break;default:this.link(e,n);break}},onModalClose:function(t){this.modal[t]=!1},onResize:function(t){console.log("resize",t)},onPaste:function(t){var e=t.clipboardData||t.originalEvent.clipboardData||window.clipboardData,n=e.items,o=!0,i=!1,a=void 0;try{for(var s,r=n[Symbol.iterator]();!(o=(s=r.next()).done);o=!0){var c=s.value;if(console.log("paste",c),"file"===c.kind){this.pasteFile=c.getAsFile(),this.modal.uploader=!0;break}}}catch(l){i=!0,a=l}finally{try{o||null==r.return||r.return()}finally{if(i)throw a}}},onFileUploaded:function(t,e){this.onMediaSelected(t,e,"Demo")},onMouseEnter:function(t){Qt&&console.log("enter",t),"editor"===t?(this.isEditorScroll=!0,this.isPreviewScroll=!1):"preview"===t&&(this.isPreviewScroll=!0,this.isEditorScroll=!1)},onMouseLeave:function(t){Qt&&console.log("leave",t)},onEditorChanged:function(){var t=this;this.isNew||this.isLoading||setTimeout((function(){t.save(null,!1)}),1e3),r["a"].nextTick((function(){document.getElementsByTagName("a")}))},onEditorScroll:function(){var t=this;if(Qt&&console.log("editor",this.isEditorScroll,this.isPreviewScroll),!this.isPreviewScroll){var e=this.cm,n=e.getScrollInfo(),o=e.coordsChar({left:n.left,top:n.top},"local").line+1;this.SetNoteLine({id:this.id,line:o});var i='[data-source-line="'+o+'"]',a=document.querySelector(i);if(a){var s=a.offsetTop,r=a.offsetParent;r&&"TABLE"===r.tagName&&(s+=r.offsetTop+31),setTimeout((function(){t.$refs.previewScroll.setScrollPosition(s,200)}),10)}}},onPreviewScroll:function(t){var e=this;if(Qt&&console.log("preview",this.isPreviewScroll,this.isEditorScroll),!this.isEditorScroll){for(var n,o=this.cm,i=0,a=t.position,s=document.querySelectorAll("[data-source-line]"),r=0;r<s.length;r++){var c=s[r],l=parseInt(c.attributes["data-source-line"].value);if(c){var u=c.offsetTop,d=c.offsetParent;if(d&&"TABLE"===d.tagName&&(u+=d.offsetTop),u>=a-20){i=l,n=c;break}}}i>=0&&n&&setTimeout((function(){e.SetNoteLine({id:e.id,line:i});var t=o.charCoords({line:i-1,ch:0},"local");o.scrollTo(0,t.top)}),10)}},scrollToLine:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEditorScroll=!0;var n=this.cm,o=t,i=e?0:200,a='[data-source-line="'+o+'"]',s=document.querySelector(a);if(s){var r=s.offsetTop,c=s.offsetParent;c&&"TABLE"===c.tagName&&(r+=c.offsetTop+31),this.$refs.previewScroll.setScrollPosition(r,i)}if(this.isPreviewScroll=!0,o=t,o>=0&&s){var l=n.charCoords({line:o-1,ch:0},"local");n.scrollTo(0,l.top)}},postTocRender:function(t){},onTocClick:function(){this.scrollToLine(this.selected),this.SetNoteLine({id:this.id,line:this.selected})},selectAll:function(){var t,e="markdown-preview",n=document.getElementById(e);if(document.body.createTextRange)t=document.body.createTextRange(),t.moveToElementText(n),t.select();else if(window.getSelection){var o=window.getSelection();t=document.createRange(),t.selectNode(n),o.removeAllRanges(),o.addRange(t)}},loadSetting:function(){this.editorOption.lineNumbers=this.lineNumber,this.editorOption.theme=this.syntaxTheme,this.isMobile&&(this.leftPanePercent=0)},showSidePanel:function(t){this.sidePanel=t},onSidePanelShow:function(){},onSidePanelClose:function(){this.showSidePanel(!1)}}),watch:{$route:function(t,e){this.handleRoute(t,e)},lineNumber:function(t,e){this.editorOption.lineNumbers=t},syntaxTheme:function(t,e){this.editorOption.theme=t},noteAction:function(t,e){var n,o,i=t.split("|");i.length>=1&&(n=i[1]),i.length>=2&&(o=i[2]),this.onAction(n,o)},revision:function(t,e){console.log("revision changed",t,e),t!==e+1&&1!==this.currentNote.type&&this.loadNote(this.currentNote.id)}},mounted:function(){Rt=this,this.bindActions(),this.handleRoute(this.$route),this.loadSetting()}},Ft=Ut,Ht=(n("4fc6"),Object(b["a"])(Ft,R,Q,!1,null,null,null)),Bt=Ht.exports,zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"note-editor row col-12"},[n("section",{staticClass:"tiptop tiptap-editor"},[n("editor-menu-bar",{attrs:{editor:t.editor},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.commands,i=e.isActive,a=e.getMarkAttrs,s=e.focused;return[n("section",{staticClass:"row col-12 justify-between items-center bg-light toolbar"},[n("div",{staticClass:"row q-px-xs menubar is-hidden",class:{"is-focused":s}},[n("o-menubar-btn",{staticClass:"note-step-add",attrs:{icon:"add",tooltip:t.$t("add")}},[n("q-menu",{ref:"addPopover",attrs:{anchor:"bottom left",self:"top left","content-class":"o-menu"},model:{value:t.menu.add,callback:function(e){t.$set(t.menu,"add",e)},expression:"menu.add"}},[n("section",[t._e(),t._e(),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-code-braces",label:t.$t("code_block")},nativeOn:{click:function(t){return o.code_block(t)}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-sigma",label:t.$t("formula"),"side-label":t.$t("block")},nativeOn:{click:function(t){return o.katex_block(t)}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-sigma",label:t.$t("formula"),"side-label":t.$t("inline")},nativeOn:{click:function(t){return o.katex_inline(t)}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-sitemap",label:t.$t("diagram_text")},nativeOn:{click:function(t){return o.diagram(t)}}},[n("q-tooltip",{attrs:{anchor:"center right",self:"center left"}},[n("div",{staticClass:"text-bold"},[t._v("Mermaid")]),n("div",{staticClass:"text-white"},[t._v(t._s(t.$t("diagram_text_tips")))])])],1),n("q-separator"),n("o-common-item",{attrs:{icon:"mdi-iframe",label:t.$t("iframe")}},[n("q-menu",{ref:"iframePopover",staticClass:"shadow-5",attrs:{anchor:"top right",self:"top left"}},[n("meta-input",{attrs:{title:t.$t("iframe"),icon:"link"},on:{primaryAction:function(e){return t.insertIframe(o.iframe,e)}}})],1)],1)],1)])],1),n("o-menubar-btn",{staticClass:"note-step-info",attrs:{icon:"info",tooltip:t.$t("note.info")}},[n("q-menu",{ref:"notePopover1",staticClass:"shadow-5",attrs:{v:"",anchor:"bottom left",self:"top left",maxWidth:"100vw",square:""},model:{value:t.menu.info,callback:function(e){t.$set(t.menu,"info",e)},expression:"menu.info"}},[n("o-note-info")],1)],1),n("o-menubar-btn",{attrs:{icon:"mdi-cloud-sync",tooltip:t.$t("action.sync")},nativeOn:{click:function(e){return t.onSave(e)}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-menubar-btn",{class:{"is-active":i.bold()},attrs:{icon:"mdi-format-bold",tooltip:t.$t("action.bold")},nativeOn:{click:function(t){return o.bold(t)}}}),n("o-menubar-btn",{class:{"is-active":i.italic()},attrs:{icon:"format_italic"},nativeOn:{click:function(t){return o.italic(t)}}}),n("o-menubar-btn",{class:{"is-active":i.strike()},attrs:{icon:"format_strikethrough"},nativeOn:{click:function(t){return o.strike(t)}}}),n("o-menubar-btn",{class:{"is-active":i.underline()},attrs:{icon:"format_underline"},nativeOn:{click:function(t){return o.underline(t)}}}),n("o-menubar-btn",{class:{"is-active":i.code()},attrs:{icon:"code"},nativeOn:{click:function(t){return o.code(t)}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-fore-color",{attrs:{commands:o,"get-mark-attrs":a}}),n("o-back-color",{attrs:{commands:o}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-align-dropdown",{attrs:{commands:o}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-heading-dropdown",{attrs:{commands:o,"is-active":i}}),t._e(),n("o-menubar-btn",{attrs:{icon:"remove"},nativeOn:{click:function(t){return o.horizontal_rule(t)}}}),n("o-menubar-btn",{class:{"is-active":i.bullet_list()},attrs:{icon:"format_list_bulleted"},nativeOn:{click:function(t){return o.bullet_list(t)}}}),n("o-menubar-btn",{class:{"is-active":i.ordered_list()},attrs:{icon:"format_list_numbered"},nativeOn:{click:function(t){return o.ordered_list(t)}}}),n("o-menubar-btn",{class:{"is-active":i.todo_list()},attrs:{icon:"mdi-format-list-checks"},nativeOn:{click:function(t){return o.todo_list(t)}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-menubar-btn",{class:{"is-active":i.blockquote()},attrs:{icon:"format_quote"},nativeOn:{click:function(t){return o.blockquote(t)}}}),n("o-menubar-btn",{class:{"is-active":i.code_block()},attrs:{icon:"mdi-code-braces"},nativeOn:{click:function(t){return o.code_block(t)}}}),n("o-menubar-btn",{attrs:{icon:"photo"}},[n("q-menu",{ref:"picturePopover",staticClass:"shadow-5",attrs:{anchor:"bottom middle",self:"top middle"}},[n("meta-input",{attrs:{title:t.$t("action.picture"),icon:"image",secondIcon:"apps",secondLabel:t.$t("action.media")},on:{secondAction:function(e){t.showMedia(o.image),t.$refs.picturePopover.hide()},primaryAction:function(e){t.insertImage(o.image,e),t.$refs.picturePopover.hide()}}})],1)],1),n("o-menubar-btn",{attrs:{icon:"mdi-table"},nativeOn:{click:function(t){return o.createTable({rowsCount:3,colsCount:3,withHeaderRow:!1})}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-menubar-btn",{class:"full"===t.view?"is-active":"",attrs:{icon:"mdi-overscan",tooltip:"Full Width"},nativeOn:{click:function(e){t.view="full"}}}),n("o-menubar-btn",{class:"page"===t.view?"is-active":"",attrs:{icon:"mdi-fit-to-page-outline",tooltip:"Fit to Page"},nativeOn:{click:function(e){t.view="page"}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-menubar-btn",{attrs:{icon:"undo"},nativeOn:{click:function(t){return o.undo(t)}}}),n("o-menubar-btn",{attrs:{icon:"redo"},nativeOn:{click:function(t){return o.redo(t)}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-menubar-btn",{attrs:{icon:"share"},nativeOn:{click:function(e){return t.onShare(e)}}}),n("o-menubar-btn",{attrs:{icon:"search"},nativeOn:{click:function(e){return t.onSearch(e)}}})],1),n("div",{staticClass:"q-px-md right-actions"},[n("o-menubar-btn",{attrs:{icon:"mdi-page-layout-sidebar-right",color:"white",flat:""},nativeOn:{click:function(e){return t.showSidePanel(!0)}}})],1)])]}}])}),n("editor-menu-bubble",{staticClass:"menububble",attrs:{editor:t.editor,keepInBounds:!0},on:{hide:t.hideLinkMenu},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.commands,i=e.isActive,a=e.getMarkAttrs,s=e.menu;return[n("div",{staticClass:"menububble",class:{"is-active":s.isActive&&0==t.selectedCellCount},style:"left: "+s.left+"px; bottom: "+s.bottom+"px;"},[t.linkMenuIsActive?n("form",{staticClass:"menububble__form",on:{submit:function(e){return e.preventDefault(),t.setLinkUrl(o.link,t.linkUrl)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.linkUrl,expression:"linkUrl"}],ref:"linkInput",staticClass:"menububble__input",attrs:{type:"text",placeholder:"https://"},domProps:{value:t.linkUrl},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.hideLinkMenu(e)},input:function(e){e.target.composing||(t.linkUrl=e.target.value)}}}),n("q-btn",{staticClass:"menububble__button",attrs:{flat:"",dense:""},on:{click:function(e){return t.setLinkUrl(o.link,null)}}},[n("q-icon",{attrs:{name:"close"}})],1)],1):[n("q-btn",{staticClass:"menububble__button",class:{"is-active":i.link()},attrs:{flat:"",dense:""},on:{click:function(e){t.showLinkMenu(a("link"))}}},[n("span",[t._v(t._s(i.link()?"Update Link":""))]),n("q-icon",{attrs:{name:"link"}})],1),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-menubar-btn",{class:{"is-active":i.bold()},attrs:{icon:"mdi-format-bold",tooltip:t.$t("action.bold")},nativeOn:{click:function(t){return o.bold(t)}}}),n("o-menubar-btn",{class:{"is-active":i.italic()},attrs:{icon:"format_italic"},nativeOn:{click:function(t){return o.italic(t)}}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-fore-color",{attrs:{commands:o,"get-mark-attrs":a}}),n("o-back-color",{attrs:{commands:o}}),n("q-separator",{attrs:{vertical:"",inset:""}}),n("o-align-group",{attrs:{commands:o,"is-active":i}})]],2)]}}])}),n("editor-menu-bubble",{staticClass:"menububble",attrs:{editor:t.editor,keepInBounds:!0},on:{hide:t.hideTableMenu},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.commands,i=e.isActive,a=(e.getMarkAttrs,e.menu);return[n("div",{staticClass:"menububble table-menu",class:{"is-active":i.table()&&!a.isActive||t.selectedCellCount>0},style:i.table()&&!a.isActive||t.selectedCellCount>0?"right: "+t.tableOffsetRight+"px; top: "+t.tableOffsetTop+"px;":"left: -100vw"},[n("o-menubar-btn",{staticClass:"col-12",attrs:{icon:"mdi-table-remove",vtooltip:"Remove Table"},nativeOn:{click:function(t){return o.deleteTable(t)}}}),n("q-separator"),n("o-menubar-btn",{staticClass:"col-12",attrs:{icon:"mdi-table-column-plus-before"},nativeOn:{click:function(t){return o.addColumnBefore(t)}}}),n("o-menubar-btn",{attrs:{icon:"mdi-table-column-plus-after"},nativeOn:{click:function(t){return o.addColumnAfter(t)}}}),n("o-menubar-btn",{attrs:{icon:"mdi-table-column-remove"},nativeOn:{click:function(t){return o.deleteColumn(t)}}}),n("q-separator"),n("o-menubar-btn",{attrs:{icon:"mdi-table-row-plus-before"},nativeOn:{click:function(t){return o.addRowBefore(t)}}}),n("o-menubar-btn",{attrs:{icon:"mdi-table-row-plus-after"},nativeOn:{click:function(t){return o.addRowAfter(t)}}}),n("o-menubar-btn",{attrs:{icon:"mdi-table-row-remove"},nativeOn:{click:function(t){return o.deleteRow(t)}}}),n("q-separator"),n("o-menubar-btn",{attrs:{icon:"mdi-table-merge-cells"},nativeOn:{click:function(t){return o.toggleCellMerge(t)}}})],1)]}}])}),n("editor-menu-bubble",{staticClass:"menububble",attrs:{editor:t.editor,keepInBounds:!0},on:{hide:t.hideTableMenu},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.commands,i=e.isActive,a=(e.getMarkAttrs,e.menu);return[n("div",{staticClass:"menububble heading-menu",class:{"is-active":i.heading()&&!a.isActive},style:i.heading()&&!a.isActive?"left: "+t.headingOffsetLeft+"px; top: "+t.headingOffsetMiddle+"px;":"left: -100vw"},[n("div",{staticClass:"row justify-center items-center full-height"},[n("span",{staticClass:"label"},[t._v(t._s(t.focusedTagName))])]),n("q-menu",{attrs:{"content-class":"o-menu"}},[n("o-heading-list",{attrs:{commands:o,"is-active":i}})],1)],1)]}}])}),n("q-scroll-area",{ref:"editorScroll",staticClass:"editor-scroll-area",class:"view-"+t.view},[n("q-scroll-observer",{on:{scroll:t.onScroll}}),n("editor-content",{staticClass:"editor__content note-step-side-editor",attrs:{editor:t.editor}})],1)],1),n("section",[n("note-side-panel",{attrs:{show:t.sidePanel},on:{show:t.onSidePanelShow,close:t.onSidePanelClose}})],1)])},Kt=[],Gt=n("cd42"),Yt=n("f23d"),Wt=n("332f"),Jt=n.n(Wt),Vt=n("4dd1"),Xt=n.n(Vt),Zt=n("ee8c"),te=n.n(Zt),ee=n("cfb4"),ne=n("4d48"),oe=n("34cf"),ie=n("5e18"),ae=n("65ab"),se=(n("3b2b"),n("fc74")),re=n.n(se),ce=n("59a1"),le=n.n(ce),ue=n("64303"),de=n.n(ue),me=n("ffe3"),fe=n.n(me),pe=n("37d9"),he=n.n(pe),be=n("a9de");function ve(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var we=function(t){function e(){return re()(this,e),de()(this,fe()(e).apply(this,arguments))}return he()(e,t),le()(e,[{key:"commands",value:function(t){var e=t.type,n=t.schema;return function(t){return Object(be["p"])(e,n.nodes.paragraph,t)}}},{key:"keys",value:function(t){var e=t.type;return this.options.levels.reduce((function(t,n){return ge({},t,{},s()({},"Shift-Ctrl-".concat(n),Object(be["k"])(e,{level:n})))}),{})}},{key:"inputRules",value:function(t){var e=t.type;return this.options.levels.map((function(t){return Object(be["o"])(new RegExp("^(#{1,".concat(t,"})\\s$")),e,(function(){return{level:t}}))}))}},{key:"name",get:function(){return"heading"}},{key:"defaultOptions",get:function(){return{levels:[1,2,3,4,5,6]}}},{key:"schema",get:function(){return{attrs:{level:{default:1},id:{default:""}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:this.options.levels.map((function(t){return{tag:"h".concat(t),attrs:{level:t}}})),toDOM:function(t){var e=t.attrs.id||ke(),n=["h".concat(t.attrs.level),{id:e,level:t.attrs.level},0];return t.attrs.id=e,n}}}}]),e}(Gt["h"]);function ke(){for(var t=[],e="0123456789abcdef",n=0;n<36;n++)t[n]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="",t.join("").substr(0,6)}var Oe=n("fd67"),ye=n("0143"),Ce=n("0faa"),qe=n("e73a"),_e=n("93e1"),Ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-btn-dropdown",{staticClass:"o-fore-color",attrs:{"menu-anchor":"bottom left","menu-self":"top left","content-class":"o-fore-color-menu",split:"",flat:""},on:{click:t.onSelectCurrent}},[n("section",{staticClass:"row justify-center label",attrs:{slot:"label"},slot:"label"},[n("div",[n("q-icon",{attrs:{name:"mdi-format-color-text"}})],1),n("div",{staticClass:"indicator",style:"background: "+t.hex})]),n("q-color",{directives:[{name:"close-popup",rawName:"v-close-popup",value:t.closable,expression:"closable"}],attrs:{"default-view":"palette"},on:{change:t.onSelect},model:{value:t.hex,callback:function(e){t.hex=e},expression:"hex"}})],1)},xe=[],Se={name:"o-fore-color",data:function(){return{hex:"#ff0000",closable:!1}},props:{commands:{type:Object},getMarkAttrs:{type:Function}},methods:{onSelectCurrent:function(){this.onSelect(this.hex)},onSelect:function(t){this.closable=!0,this.commands.foreColor({foreColor:t})}},computed:{}},Te=Se,je=(n("1db4"),Object(b["a"])(Te,Ne,xe,!1,null,null,null)),Pe=je.exports,$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-btn-dropdown",{staticClass:"o-back-color",attrs:{"menu-anchor":"bottom left","menu-self":"top left","content-class":"o-back-color-menu",split:"",flat:""},on:{click:t.onSelectCurrent}},[n("section",{staticClass:"row justify-center label",attrs:{slot:"label"},slot:"label"},[n("div",[n("q-icon",{attrs:{name:"mdi-format-color-highlight"}})],1),n("div",{staticClass:"indicator",style:"background: "+t.hex})]),n("q-color",{directives:[{name:"close-popup",rawName:"v-close-popup",value:t.closable,expression:"closable"}],attrs:{"default-view":"palette"},on:{change:t.onSelect},model:{value:t.hex,callback:function(e){t.hex=e},expression:"hex"}})],1)},Ee=[],Ae={name:"o-back-color",data:function(){return{hex:"#ffff00",closable:!1}},props:{commands:{type:Object}},methods:{onSelectCurrent:function(){this.onSelect(this.hex)},onSelect:function(t){this.closable=!0,this.commands.backColor({backColor:t})}},computed:{}},Le=Ae,Me=(n("7741"),Object(b["a"])(Le,$e,Ee,!1,null,null,null)),De=Me.exports,Ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-btn-dropdown",{staticClass:"o-align-dropdown",attrs:{icon:"format_align_center","menu-anchor":"bottom left","menu-self":"top left","content-class":"o-menu o-align-dropdown-menu",dense:"",flat:""}},[n("q-list",[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.align({textAlign:"left"})}}},[n("q-item-section",{attrs:{side:""}},[n("q-icon",{attrs:{name:"format_align_left"}})],1),n("q-item-section",[t._v("左对齐")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.align({textAlign:"center"})}}},[n("q-item-section",{attrs:{side:""}},[n("q-icon",{attrs:{name:"format_align_center"}})],1),n("q-item-section",[t._v("居中对齐")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.align({textAlign:"right"})}}},[n("q-item-section",{attrs:{side:""}},[n("q-icon",{attrs:{name:"format_align_right"}})],1),n("q-item-section",[t._v("右对齐")])],1)],1)],1)},Re=[],Qe={name:"o-menubar-btn",data:function(){return{}},props:{commands:{type:Object}},methods:{},computed:{}},Ue=Qe,Fe=(n("3a26"),Object(b["a"])(Ue,Ie,Re,!1,null,null,null)),He=Fe.exports,Be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"o-align-group"},[n("o-menubar-btn",{class:{"is-active":t.isActive.align({textAlign:"left"})},attrs:{icon:"format_align_left"},nativeOn:{click:function(e){return t.commands.align({textAlign:"left"})}}}),n("o-menubar-btn",{class:{"is-active":t.isActive.align({textAlign:"center"})},attrs:{icon:"format_align_center"},nativeOn:{click:function(e){return t.commands.align({textAlign:"center"})}}}),n("o-menubar-btn",{class:{"is-active":t.isActive.align({textAlign:"right"})},attrs:{icon:"format_align_right"},nativeOn:{click:function(e){return t.commands.align({textAlign:"right"})}}})],1)},ze=[],Ke={name:"o-align-group",data:function(){return{}},props:{commands:{type:Object},isActive:{type:Object}},components:{OMenubarBtn:_e["a"]},methods:{onTest:function(){console.log("test",this.isActive)}},computed:{}},Ge=Ke,Ye=(n("3eda"),Object(b["a"])(Ge,Be,ze,!1,null,null,null)),We=Ye.exports,Je=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-btn-dropdown",{staticClass:"o-heading-dropdown",attrs:{icon:"mdi-format-header-pound","menu-anchor":"bottom left","menu-self":"top left","content-class":"o-menu o-heading-dropdown-menu",flat:""}},[n("o-heading-list",{attrs:{commands:t.commands,"is-active":t.isActive}})],1)},Ve=[],Xe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-list",{staticClass:"o-heading-list"},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],class:{"is-active":t.isActive.paragraph()},attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.paragraph(e)}}},[n("q-item-section",{attrs:{side:""}},[n("q-icon",{attrs:{name:"mdi-format-pilcrow"}})],1),n("q-item-section",[t._v("正文")])],1),n("q-separator"),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],class:{"is-active":t.isActive.heading({level:1})},attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.heading({level:1})}}},[n("q-item-section",{attrs:{side:""}},[t._v("H1")]),n("q-item-section",[t._v("H1 标题")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],class:{"is-active":t.isActive.heading({level:2})},attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.heading({level:2})}}},[n("q-item-section",{attrs:{side:""}},[t._v("H2")]),n("q-item-section",[t._v("H2 标题")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],class:{"is-active":t.isActive.heading({level:3})},attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.heading({level:3})}}},[n("q-item-section",{attrs:{side:""}},[t._v("H3")]),n("q-item-section",[t._v("H3 标题")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],class:{"is-active":t.isActive.heading({level:4})},attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.heading({level:4})}}},[n("q-item-section",{attrs:{side:""}},[t._v("H4")]),n("q-item-section",[t._v("H4 标题")])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],class:{"is-active":t.isActive.heading({level:5})},attrs:{clickable:""},nativeOn:{click:function(e){return t.commands.heading({level:5})}}},[n("q-item-section",{attrs:{side:""}},[t._v("H5")]),n("q-item-section",[t._v("H5 标题")])],1)],1)},Ze=[],tn={name:"o-heading-list",data:function(){return{}},props:{commands:{type:Object},isActive:{type:Object}},methods:{},computed:{}},en=tn,nn=(n("0bd1"),Object(b["a"])(en,Xe,Ze,!1,null,null,null)),on=nn.exports,an={name:"o-heading-dropdown",data:function(){return{}},props:{commands:{type:Object},isActive:{type:Object}},components:{OHeadingList:on},methods:{},computed:{}},sn=an,rn=(n("2d40"),Object(b["a"])(sn,Je,Ve,!1,null,null,null)),cn=rn.exports,ln=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"o-heading-group"},[n("o-menubar-btn",{class:{"is-active":t.isActive.paragraph()},attrs:{icon:"mdi-format-pilcrow"},nativeOn:{click:function(e){return t.commands.paragraph(e)}}}),t._l(t.maxLevel,(function(e){return n("o-menubar-btn",{key:e,class:{"is-active":t.isActive.heading({level:e})},attrs:{label:"H"+e},nativeOn:{click:function(n){return t.commands.heading({level:e})}}})}))],2)},un=[],dn=(n("c5f6"),{name:"o-heading-group",data:function(){return{}},props:{max:{type:Number,default:3},commands:{type:Object},isActive:{type:Object}},components:{OMenubarBtn:_e["a"]},methods:{},computed:{maxLevel:function(){var t=this.max;return this.max<1&&(t=3),this.max>5&&(t=5),t}}}),mn=dn,fn=(n("cb14"),Object(b["a"])(mn,ln,un,!1,null,null,null)),pn=fn.exports,hn=n("a9fb"),bn=n("10a8"),vn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-dialog",{ref:"modal",staticClass:"sidePanel",attrs:{position:"right",maximized:"",seamless:"",square:"","content-class":"note-side-panel"},on:{show:function(e){return t.$emit("show")},hide:function(e){return t.$emit("close")}}},[n("q-layout",{staticClass:"bg-secondary note-step-side-panel",staticStyle:{width:"50%","min-width":"400px"},attrs:{view:"lhh lpR fff"}},[n("q-header",{staticClass:"bg-secondary"},[n("q-toolbar",[n("q-toolbar-title",[n("section",{staticClass:"row col-12"},[n("q-tabs",{ref:"tabs",staticClass:"bg-secondary text-text",attrs:{align:"left","inline-label":""},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},t._l(t.tabs,(function(t,e){return n("q-tab",{key:e,attrs:{name:t.value,label:t.label}})})),1)],1)]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close",size:"1rem",color:"primary"}})],1)],1),n("q-page-container",[n("q-page",[n("section",{staticClass:"content-container themed"},[n("section",{directives:[{name:"show",rawName:"v-show",value:"basic"==t.currentTab,expression:"currentTab=='basic'"}],staticClass:"col-12"},[n("q-list",{attrs:{"no-border":"",link:"","inset-delimiter":""}},[n("q-item-label",{staticClass:"text-uppercase text-blue-grey-5 q-pa-md"},[t._v(t._s(t.$t("label.shareExport")))]),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"share",label:t.$t("action.share")},nativeOn:{click:function(e){return t.onAction("note-action-share")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-file-pdf-box",label:t.$t("action.pdf")},nativeOn:{click:function(e){return t.onAction("note-action-export-pdf")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-language-html5",label:t.$t("action.exportHtml")},nativeOn:{click:function(e){return t.onAction("note-action-export-html")}}})],1),n("q-list",{attrs:{"no-border":"",link:"","inset-delimiter":""}},[n("q-item-label",{staticClass:"text-uppercase text-blue-grey-5 q-pa-md"},[t._v(t._s(t.$t("label.help")))]),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-tooltip-text",label:t.$t("tour")},nativeOn:{click:function(e){return t.action("M_SET_TOUR_ACTION","note")}}}),n("o-common-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"mdi-keyboard",label:t.$t("action.shortcut")},nativeOn:{click:function(e){return t.onAction("note-action-shortcut")}}})],1)],1),n("section",{directives:[{name:"show",rawName:"v-show",value:"toc"==t.currentTab,expression:"currentTab=='toc'"}],staticStyle:{width:"100%",height:"100%"}},[n("q-scroll-area",{ref:"tocScroll",staticStyle:{width:"100%",height:"100%"}},[n("q-tree",{ref:"tocTree",staticClass:"themed",attrs:{nodes:t.tocTree,selected:t.selectedTocItem,"node-key":"key","default-expand-all":"",color:"text",id:"noteTocTree","no-connectors":""},on:{"update:selected":function(e){t.selectedTocItem=e}},nativeOn:{click:function(e){return t.onTocClick(e)}},scopedSlots:t._u([{key:"header-heading",fn:function(e){return n("div",{staticClass:"row items-center",attrs:{"data-source-line":e.node.heading.key}},[n("div",{},[t._v(t._s(e.node.label))])])}}])})],1)],1),n("section",{directives:[{name:"show",rawName:"v-show",value:"qnote"===t.currentTab,expression:"currentTab==='qnote'"}],staticClass:"panel"},[n("header",{staticClass:"text-text-active"},[t.currentNote.qtag?n("section",{staticClass:"row col-12 justify-between items-center"},[n("div",[t._v("已关联快速笔记")]),n("div",[n("q-btn",{attrs:{label:"单独查看",color:"primary",to:"/quicknote/tag/"+t.currentNote.qtag,flat:""}}),n("q-btn",{attrs:{label:"更改关联",color:"primary",flat:""},on:{click:function(e){return t.showQtag(!0)}}})],1)]):n("section",{staticClass:"row col-12 justify-between items-center"},[n("div",[t._v("未关联快速笔记")]),n("div",[n("q-btn",{attrs:{label:"去关联",color:"primary",flat:""},on:{click:function(e){return t.showQtag(!0)}}})],1)])]),n("section",{staticClass:"qnote-container"},[t.currentNote.qtag?n("section",[n("note-quicknote",{attrs:{id:t.qtag}})],1):n("section",{staticClass:"q-pa-md text-text"},[t._v("\n                快速笔记可以帮助您：\n                "),n("ul",[n("li",[t._v("提供写作的上下文环境")]),n("li",[t._v("收集零散知识")])])])])]),n("section",{directives:[{name:"show",rawName:"v-show",value:"history"===t.currentTab,expression:"currentTab==='history'"}]},[n("section",{staticClass:"row col-12 q-pa-md justify-center"},[t._v("\n              敬请期待！\n            ")])])]),n("section",[n("o-common-dialog",{attrs:{title:t.$t("action.move"),icon:"swap_vert",show:t.showQtagDialog},on:{show:t.onQtagShow,close:t.onQtagClose,confirm:t.onQtagConfirm}},[n("template",{slot:"content"},[n("section",{staticClass:"relative-position"},[n("o-qtag-select",{on:{input:t.onQtagSelect}})],1)])],2)],1)])],1)],1)],1)},gn=[];function wn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function kn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wn(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var On={name:"note-side-panel",mixins:[C["a"]],data:function(){return{currentTab:"basic",showQtagDialog:!1,qtag:"",selectedQtag:"",selectedTocItem:""}},props:{show:{type:Boolean,default:!1}},components:{OCommonDialog:J["a"],OCommonItem:O["a"],OQtagSelect:at,NoteQuicknote:yt},computed:kn({},Object(y["c"])({currentNote:"currentNote",tocTree:"noteToc"}),{tabs:function(){return[{label:this.$t("label.basic"),value:"basic",icon:"info"},{label:this.$t("label.toc"),value:"toc",icon:"format_align_justify"},{label:this.$t("quicknote"),value:"qnote",icon:"reorder"},{label:"历史记录",value:"history",icon:"timer"}]},currentNoteId:function(){return this.currentNote.id}}),methods:kn({},Object(y["b"])({UpdateNote:"UpdateNote"}),{onAction:function(t,e){t=(new Date).getTime()+"|"+t,e&&(t+="|"+e),this.$store.commit("setNoteAction",t)},onTabChanged:function(){},onTocClick:function(){this.selectedTocItem&&this.onAction("note-toc-id",this.selectedTocItem)},showQtag:function(t){this.showQtagDialog=t},onQtagShow:function(){this.selectedQtag=""},onQtagClose:function(){this.showQtag(!1)},onQtagConfirm:function(){if(this.selectedQtag){var t={id:this.currentNote.id,qtag:this.selectedQtag};console.log("save qtag",t),this.UpdateNote(t),this.qtag=this.selectedQtag}},onQtagSelect:function(t){this.selectedQtag=t.key},onRoute:function(t,e){}}),watch:{$route:function(t,e){this.onRoute(t,e)},show:function(t,e){t?(this.qtag=this.currentNote.qtag||"",this.$refs.modal.show()):this.$refs.modal.hide()},currentNoteId:function(t,e){this.qtag=this.currentNote.qtag||""}},mounted:function(){this.show&&this.$refs.modal.show()}},yn=On,Cn=(n("4fbe"),Object(b["a"])(yn,vn,gn,!1,null,null,null)),qn=Cn.exports;function _n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Nn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_n(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var xn={name:"note-editor",mixins:[C["a"],_["a"],Mt["a"]],data:function(){return{menu:{add:!1,info:!1},view:"page",id:"",notebook:"default",isNew:!1,isLoading:!1,editor:null,json:{},html:"",linkUrl:null,linkMenuIsActive:!1,scrollHeight:0,focusOffsetTop:0,focusOffsetWidth:0,focusElementHeight:0,selectedCellSize:0,focusedTagName:"",sidePanel:!1}},components:{EditorContent:Gt["c"],EditorMenuBar:Gt["d"],EditorMenuBubble:Gt["e"],OMenubarBtn:_e["a"],OCommonItem:O["a"],OForeColor:Pe,OBackColor:De,OAlignDropdown:He,OAlignGroup:We,OHeadingDropdown:cn,OHeadingGroup:pn,OHeadingList:on,ONoteInfo:hn["a"],MetaInput:bn["a"],NoteSidePanel:qn},methods:Nn({},Object(y["b"])({SaveNote:"SaveNote",A_QUERY_RECENT_NOTE:"A_QUERY_RECENT_NOTE"}),{initEditor:function(){var t=this;this.editor=new Gt["b"]({extensions:[new ee["a"],new ne["a"],new oe["a"],new ie["a"],new ae["a"],new Yt["a"],new Yt["c"],new Yt["e"],new Yt["f"]({languages:{java:Jt.a,javascript:Xt.a,css:te.a}}),new Yt["h"],new we({levels:[1,2,3,4,5]}),new Yt["o"],new Yt["p"],new Yt["n"],new Yt["b"],new Yt["d"],new Yt["m"],new Yt["r"],new Yt["z"],new Yt["j"],new Yt["w"]({nested:!0}),new Yt["x"],new Yt["s"]({resizable:!0}),new Yt["u"],new Yt["t"],new Yt["v"],new Yt["q"]({showOnlyCurrent:!1,emptyNodeText:function(e){return"title"===e.type.name?t.$t("label.title"):"正文"}}),new Yt["g"]({className:"has-focus",nested:!0}),new Yt["k"],new Yt["y"]({node:"paragraph",notAfter:["paragraph"]}),new Yt["l"],new Oe["a"],new ye["a"],new Ce["a"],new qe["a"]],keys:{"Mod-s":function(){console.log("sssssss")}},autoFocus:!0,content:"",editorProps:{handleKeyPress:function(t,e){},handlePaste:function(t,e,n){}},onUpdate:function(e){e.state;var n=e.getJSON,o=e.getHTML;t.json=n(),t.html=o(),t.isNew||t.isLoading||t.save(null,!1)},onTransaction:function(e){var n=e.state;t.updateToc(n.doc.content.content);var o=document.querySelectorAll(".has-focus"),i=o.length;if(i>0){var a=o[0],s=a.offsetTop,r=a.offsetHeight;t.focusOffsetTop=s+40,t.focusElementHeight=r,t.focusedTagName=a.tagName,console.log("focus",o)}var c=document.querySelectorAll(".note-editor");t.focusOffsetWidth=parseInt((c[0].offsetWidth-800)/2);var l=document.querySelectorAll(".selectedCell");t.selectedCellSize=l.length}})},setContent:function(){this.json.type||(this.json={type:"doc",content:[]}),this.editor.setContent(this.json,!0),this.editor.focus()},cleanContent:function(){this.editor.clearContent(!1),this.editor.focus()},updateToc:function(t){var e=[],n={},o=!0,i=!1,a=void 0;try{for(var s,r=t[Symbol.iterator]();!(o=(s=r.next()).done);o=!0){var c=s.value;if("title"===c.type.name)n={key:"title",type:"title",level:1,label:c.content&&c.content.content&&c.content.content[0]?c.content.content[0].text:""};else if("heading"===c.type.name){var l={key:c.attrs.id||Object(ft["b"])(),type:"heading",level:c.attrs.level,label:c.content&&c.content.content&&c.content.content[0]?c.content.content[0].text:""};e.push(l)}}}catch(m){i=!0,a=m}finally{try{o||null==r.return||r.return()}finally{if(i)throw a}}var u={children:[]};e.forEach((function(t){if(!(t.level<1||t.level>6)){for(var e=1,n=u;e<t.level;e++)0===n.children.length&&n.children.push({label:"",heading:{},children:[]}),n=n.children[n.children.length-1];n.children.push({key:t.key,type:t.type,label:t.label,heading:t,children:[]})}}));var d=u.children;d&&d.length>0?(n.children=d[0].children,d[0]=n,this.$store.commit("M_SET_NOTE_TOC",d)):this.$store.commit("M_SET_NOTE_TOC",[])},onTocClick:function(t){var e='[id="'.concat(t,'"]'),n=document.querySelector(e);if(n){var o=n.offsetTop+50;this.$refs.editorScroll.setScrollPosition(o,200)}else"title"===t&&this.$refs.editorScroll.setScrollPosition(0,200)},showLinkMenu:function(t){var e=this;this.linkUrl=t.href,this.linkMenuIsActive=!0,this.$nextTick((function(){e.$refs.linkInput.focus()}))},hideLinkMenu:function(){this.linkUrl=null,this.linkMenuIsActive=!1},setLinkUrl:function(t,e){t({href:e}),this.hideLinkMenu()},showImagePrompt:function(t){var e=prompt("Enter the url of your image here");null!==e&&t({src:e})},showMedia:function(t){Object(At["a"])({type:"media",data:{type:"note",command:t},callback:this.insertImage})},insertImage:function(t,e){e&&t({src:e})},insertIframe:function(t,e){e&&t({src:e})},onScroll:function(t){this.scrollHeight=t.position},hideTableMenu:function(){console.log("hide table menu")},getTitle:function(){var t="",e=this.json.content;if(e&&e.length>0){var n=e[0].content;n&&n.length>0&&(t=n[0].text)}return t||""},create:function(){var t=this;if(console.log("create"),this.reset(),"New Note"===this.currentNote.title)console.log("Current is new note"),this.loadNote(this.currentNote.id),this.$router.push({name:"note_new"});else{var e=this;this.$nextTick((function(){t.save((function(t){e.isNew=!1,e.$router.push({name:"note",params:{id:t.id}})}),!1)}))}},save:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.id?this.id:Object(ft["b"])(),i=this.notebook?this.notebook:this.currentNotebookId,a={id:o,type:1,notebook:i,draft:JSON.stringify(this.json),state:0,isSync:n};this.SaveNote(a).then((function(o){n&&(e.id?e.notifySuccess(e.$t("note.tip.synced"),"top"):e.notifyInfo(e.$t("note.tip.created"),"top")),e.postLoadNote(o),e.openNote(o),t&&t(o)})).catch((function(t){t.message.indexOf("Cancel")>=0?Object(At["a"])({type:"auth-tips",tips:"同步可以将笔记内容保存在云端",icon:"mdi-cloud-sync"}):console.log(t)}))},loadNote:function(t){var e=this;this.isLoading=!0,Object($t["a"])(t).then((function(t){1===t.type&&(e.notebook=t.notebook,e.json=JSON.parse(t.draft),e.setContent(),e.postLoadNote(t),e.openNote(t),e.$nextTick((function(){e.isLoading=!1})))}))},postLoadNote:function(t){this.id=t.id,this.cacheNote(t.id),this.$store.commit("SET_CURRENT_NOTE",t),this.A_QUERY_RECENT_NOTE(),t.title&&(document.title="Donote | "+t.title)},openNote:function(t){this.$store.commit("OPEN_NOTE",t)},cacheNote:function(t){localStorage.setItem("LAST_NOTE",t)},bindActions:function(){var t=this;B.a.bind(["command+s","ctrl+s"],(function(){return t.onAction("note-action-save")})),B.a.bind(["command+f","ctrl+f"],(function(){return t.onAction("note-action-find")})),B.a.bind(["command+shift+s","ctrl+shift+s"],(function(){return t.onAction("note-action-share")})),B.a.bind(["command+p","ctrl+p"],(function(){return t.onAction("note-action-print")})),B.a.bind(["command+enter","ctrl+enter"],(function(){return t.onAction("note-action-view")}))},onAction:function(t,e){switch(t){case"note-action-add":this.create();break;case"note-action-menu-add":this.menu.add=!0;break;case"note-action-menu-info":this.menu.info=!0;break;case"note-action-save":this.save(),console.log("save");break;case"note-action-share":this.onShare();break;case"note-action-find":this.onSearch();break;case"note-side-panel":this.showSidePanel(!0);break;case"note-side-panel-off":this.showSidePanel(!1);break;case"note-action-view":this.onToggleView();break;case"note-action-export-pdf":case"note-action-print":this.onPrint();break;case"note-toc-id":this.onTocClick(e);break}return!1},onSave:function(){this.save()},onShare:function(){this.isLogin?Object(At["a"])({type:"share",content:"note"}):Object(At["a"])({type:"auth-tips",tips:"分享可以通过链接把笔记分享给好友",color:"purple",icon:"share"})},onSearch:function(){Object(At["a"])({type:"search"})},showSidePanel:function(t){this.sidePanel=t},onSidePanelShow:function(){},onSidePanelClose:function(){this.showSidePanel(!1)},onToggleView:function(){this.view="page"===this.view?"full":"page"},onPrint:function(){var t=this;setTimeout((function(){t.$nextTick((function(){window.print()}))}),1e3)},reset:function(){this.json={},this.isNew=!0,this.notebook="",this.id="",this.cleanContent()},onRoute:function(t,e){if("note_new"===t.name)this.create();else if("note"===t.name){console.log("open note");var n=t.params.id;n&&this.loadNote(n)}else this.showSidePanel(!1)}}),computed:Nn({},Object(y["c"])({noteAction:"noteAction",currentNote:"currentNote",currentNotebookId:"currentNotebookId",currentMedia:"currentMedia"}),{focusHeight:function(){return this.focusOffsetTop-this.scrollHeight},selectedCellCount:function(){return this.selectedCellSize},tableOffsetTop:function(){var t="page"===this.view?this.focusHeight+54:this.focusHeight+40;return t=t>45?t:45,t},tableOffsetRight:function(){return"page"===this.view?this.focusOffsetWidth-14:-14},headingOffsetTop:function(){var t="page"===this.view?this.focusHeight+54:this.focusHeight+40;return t},headingOffsetMiddle:function(){return this.headingOffsetTop+this.focusElementHeight/2},headingOffsetLeft:function(){return"page"===this.view?this.focusOffsetWidth+26:26}}),watch:{$route:function(t,e){this.onRoute(t,e)},noteAction:function(t,e){var n,o,i=t.split("|");i.length>=1&&(n=i[1]),i.length>=2&&(o=i[2]),this.onAction(n,o)}},created:function(){},mounted:function(){this.initEditor(),this.bindActions(),this.onRoute(this.$route)},deactivated:function(){this.showSidePanel(!1)},beforeDestroy:function(){this.editor.destroy()}},Sn=xn,Tn=(n("1217"),Object(b["a"])(Sn,zt,Kt,!1,null,null,null)),jn=Tn.exports,Pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("o-common-page",{staticClass:"notebook-details"},[n("header",{staticClass:"bg-primary"}),n("section",{staticClass:"q-pa-md"},[n("q-breadcrumbs",[n("q-breadcrumbs-el",{staticClass:"text-blue",attrs:{icon:"home",label:"开始",to:"/welcome"}}),n("q-breadcrumbs-el",{attrs:{label:t.notebook.name}})],1)],1),n("section",{staticClass:"row col-12 justify-center notebook"},[n("article",{staticClass:"col-10"},[n("section",{staticClass:"bg-light text-text meta"},[n("div",{staticClass:"row justify-between items-center"},[n("div",{staticClass:"row items-center title"},[n("q-icon",{attrs:{name:"book"}}),n("div",{staticClass:"q-ml-md"},[t._v(t._s(t.notebook.name))])],1),n("div",[n("q-btn",{attrs:{icon:"share",flat:"",round:""},on:{click:t.onShare}})],1)]),n("div",{staticClass:"desc"},[t._v("\n          这是一个笔记本\n        ")])]),n("section",{staticClass:"notes"},[n("div",[n("q-list",{staticClass:"o-navi-list bg-secondary",attrs:{"no-border":"",link:"","inset-delimiter":""}},t._l(t.notebookNotes,(function(e,o){return n("o-common-item",{key:o,staticClass:"stripped",attrs:{icon:1===e.type?"mdi-file-document-box":"mdi-markdown",label:e.title,sideLabel:t.timeMulti(e.cedittime).timestamp,clickable:""},nativeOn:{click:function(n){return t.openNote(e)}}})})),1)],1)])])])])},$n=[],En=n("887d"),An=n("6eb0");function Ln(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Mn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ln(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Dn={name:"notebook-details",mixins:[C["a"],q["a"],_["a"]],data:function(){return{id:"",notebook:{}}},components:{OCommonPage:En["a"],OCommonItem:O["a"]},computed:Mn({},Object(y["c"])({recentNotes:"recentNotes"}),{notebookNotes:function(){var t=this,e=function(e){switch(t.id){case"all":return!0;case"star":return 1===e.star;default:return e.notebook===t.notebook}};return"recent"===this.id?this.recentNotes:this.notes.filter(e)}}),methods:Mn({},Object(y["b"])({A_SET_CURRENT_NOTEBOOK:"A_SET_CURRENT_NOTEBOOK"}),{loadNotebook:function(){var t=this;Object(An["b"])(this.id).then((function(e){e&&e.id&&(t.notebook=e,t.A_SET_CURRENT_NOTEBOOK(e))}))},onShare:function(){Object(At["a"])({type:"share",content:"notebook"})},onRoute:function(t,e){"notebook-details"===t.name&&(this.id=t.params.id,this.loadNotebook())}}),watch:{$route:function(t,e){this.onRoute(t,e)}},mounted:function(){this.onRoute(this.$route)}},In=Dn,Rn=(n("de0f"),Object(b["a"])(In,Pn,$n,!1,null,null,null)),Qn=Rn.exports,Un=n("bd1c"),Fn=n("5d2d");function Hn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hn(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}r["a"].use(l.a);var zn={name:"page-editor-home",mixins:[_["a"]],data:function(){return{term:"",notebook:"",notebookName:"Notes",noteSortKey:"0-desc",isPinned:!1,inProgress:!1,isShowNoteList:!1,contentClass:"col-xs-12 col-sm-12 col-md-12",tipDelay:500}},components:{OEditorWelcome:I,MarkdownEditor:Bt,NoteEditor:jn,NotebookDetails:Qn,OTooltipBottom:Un["a"],OCommonItem:O["a"]},methods:Bn({},Object(y["b"])({UpdateNote:"UpdateNote",RemoveNote:"RemoveNote"}),{onClickOutside:function(t){this.isPinned||this.inProgress||this.showNoteList(!1)},showNoteList:function(t){this.isShowNoteList=t},notebookDetails:function(){this.showNoteList(!1),this.$router.push("/notebook/details/".concat(this.notebook))},togglePin:function(){this.isPinned=!this.isPinned,Object(Fn["h"])("pin-note-list",this.isPinned)},openNotebook:function(t){this.notebook=t,this.showNoteList(!0),"defalut"!==t&&"all"!==t&&"star"!==t||(t=""),this.term="",this.$store.commit("SET_CURRENT_NOTEBOOK_ID",t)},onOpenNote:function(t){console.log("onOpenNote",this.isPinned),this.showNoteList(this.isPinned),this.openNote(t)},starNote:function(t,e){var n={id:t.id,star:e};this.UpdateNote(n)},beforeDelete:function(t){var e=this;this.$q.dialog({title:this.$t("label.tips"),message:this.$t("remove.tip",{tip:t.title}),ok:this.$t("action.confirm"),cancel:this.$t("action.cancel")}).onOk((function(){e.RemoveNote({id:t.id,isCloud:!1})}))},shareNotebook:function(){Object(At["a"])({type:"share",content:"notebook"})},onDragStart:function(t,e){e.contentType="note",t.dataTransfer.setData("text",JSON.stringify(e)),t.dataTransfer.dropEffect="move"},onRoute:function(t){var e=t.name,n=t.params.id,o=t.params.name;"notebook"===e&&(this.openNotebook(n),o&&(this.notebookName=o))},loadNotes:function(){this.$store.dispatch("A_QUERY_NOTE")},sortNote:function(t,e){return"a-asc"===this.noteSortKey?t.title.toLowerCase()<e.title.toLowerCase()?-1:1:"a-desc"===this.noteSortKey?t.title.toLowerCase()>e.title.toLowerCase()?-1:1:"0-desc"===this.noteSortKey?t.cedittime>e.cedittime?-1:1:t.cedittime<e.cedittime?-1:1},searchFilter:function(t){return function(e){var n=e.title.toLowerCase(),o=n.indexOf(t.toLowerCase());return t.length>1?o>=0:0===o}},handleSortNote:function(t){var e=this;this.inProgress=!0;var n=this.noteSortKey.substr(0,1);"title"===t?"a"===n&&"a-asc"===this.noteSortKey?this.noteSortKey="a-desc":this.noteSortKey="a-asc":"0"===n?"0-asc"===this.noteSortKey?this.noteSortKey="0-desc":this.noteSortKey="0-asc":this.noteSortKey="0-desc",setTimeout((function(){e.inProgress=!1}),500)}}),computed:Bn({},Object(y["c"])({notes:"notes",currentNotebook:"currentNotebook",openedNotebook:"openedNotebook",currentNote:"currentNote",openedNotes:"openedNotes",recentNotes:"recentNotes",showSidebar:"showSidebar"}),{noteList:function(){var t=this,e=function(e){switch(t.notebook){case"all":return!0;case"star":return 1===e.star;default:return e.notebook===t.notebook}};return"recent"===this.notebook?this.recentNotes.filter(this.searchFilter(this.term)).sort(this.sortNote):this.notes.filter(e).filter(this.searchFilter(this.term)).sort(this.sortNote)},noteListClass:function(){return this.showSidebar?"with-sidebar":""},view:function(){var t="welcome",e=this.$route.name;return e.indexOf("notebook-details")>=0?"notebook-details":(this.openedNotes.length>0&&"welcome"!==e&&(t=e.indexOf("notebook")>=0?1===this.currentNote.type?"note":"markdown":e.indexOf("markdown")>=0?"markdown":e.indexOf("note")>=0?"note":1===this.currentNote.type?"note":"markdown"),t)},styles:function(){return"view-".concat(this.view)},notebookId:function(){return this.currentNotebook.id}}),watch:{$route:function(t,e){this.onRoute(t)},openedNotebook:function(t,e){var n=t.split("|"),o=n[0];this.openNotebook(o)},notebookId:function(t,e){console.log("notebookId",t)}},created:function(){},mounted:function(){var t=Object(Fn["a"])("pin-note-list");this.isPinned="true"===t,this.onRoute(this.$route),this.loadNotes()}},Kn=zn,Gn=(n("869e"),Object(b["a"])(Kn,o,i,!1,null,null,null));e["default"]=Gn.exports},"66ce":function(t,e,n){"use strict";var o=n("4c74"),i=n.n(o);i.a},7741:function(t,e,n){"use strict";var o=n("a19b"),i=n.n(o);i.a},"7a81":function(t,e,n){},8105:function(t,e,n){},"869e":function(t,e,n){"use strict";var o=n("be39"),i=n.n(o);i.a},9557:function(t,e,n){},9926:function(t,e,n){},"9bea":function(t,e,n){"use strict";var o=n("9926"),i=n.n(o);i.a},a19b:function(t,e,n){},a1d7:function(t,e,n){},a4da:function(t,e,n){},bc97:function(t,e,n){"use strict";var o=n("1714"),i=n.n(o);i.a},be39:function(t,e,n){},c1c2:function(t,e,n){"use strict";var o=n("a1d7"),i=n.n(o);i.a},cb14:function(t,e,n){"use strict";var o=n("5f28"),i=n.n(o);i.a},ccd7:function(t,e,n){},ce6c:function(t,e,n){},de0f:function(t,e,n){"use strict";var o=n("0bc2"),i=n.n(o);i.a},e076:function(t,e,n){"use strict";var o=n("ce6c"),i=n.n(o);i.a},e7b5:function(t,e,n){},ff54:function(t,e,n){}}]);